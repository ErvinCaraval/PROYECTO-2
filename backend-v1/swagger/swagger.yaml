
openapi: 3.0.0
info:
  title: BrainBlitz API - Documentaci√≥n Completa
  version: 2.0.0
  description: |
    API Backend de **BrainBlitz**, el juego de trivia multijugador con accesibilidad de voz integrada.  
    Aqu√≠ encontrar√°s todos los endpoints REST disponibles, sus par√°metros, ejemplos de uso y descripciones completas.

    **Caracter√≠sticas principales:**
    - ‚úÖ Autenticaci√≥n con Firebase Auth
    - ‚úÖ Modo accesibilidad con voz (Voice-to-Text y Text-to-Speech)
    - ‚úÖ Reconocimiento facial para login
    - ‚úÖ Generaci√≥n de preguntas con IA (OpenAI)
    - ‚úÖ OCR para escanear im√°genes
    - ‚úÖ Procesamiento de audio con AssemblyAI
    - ‚úÖ Rate limiting y protecci√≥n contra abuso
    - ‚úÖ Estad√≠sticas en tiempo real

    **Notas importantes:**
    - Todas las respuestas est√°n en formato JSON.
    - Algunos endpoints requieren autenticaci√≥n mediante Bearer Token (Firebase JWT).
    - Puedes probar todos los endpoints desde `/api-docs` en el servidor en ejecuci√≥n.

    ---
    ## URLs de Despliegue
    
    ### üåê Producci√≥n
    - **Frontend:** [https://frontend-v2-latest.onrender.com](https://frontend-v2-latest.onrender.com)
    - **Backend API:** [https://backend-v1-latest.onrender.com](https://backend-v1-latest.onrender.com)
    - **Documentaci√≥n Swagger:** [https://backend-v1-latest.onrender.com/api-docs](https://backend-v1-latest.onrender.com/api-docs)

    ### üíª Desarrollo Local
    - **Backend:** http://localhost:5000
    - **Frontend:** http://localhost:3000 (o http://localhost:5173)
    - **Facial Service:** http://localhost:5001

    ---
    ## Ejemplo de uso

    **Registrar usuario:**
    ```bash
    curl -X POST https://backend-v1-latest.onrender.com/api/users/register \
      -H "Content-Type: application/json" \
      -d '{"email":"test@correo.com","password":"123456","displayName":"Test"}'
    ```

    **Generar preguntas con IA:**
    ```bash
    curl -X POST https://backend-v1-latest.onrender.com/api/ai/generate-questions \
      -H "Authorization: Bearer <TOKEN>" \
      -H "Content-Type: application/json" \
      -d '{"topic":"ciencia","difficulty":"medium","count":5,"useAI":true}'
    ```

servers:
  - url: https://backend-v1-latest.onrender.com
    description: üåê Entorno de Producci√≥n (Render)
  - url: http://localhost:5000
    description: üíª Entorno Local

tags:
  - name: Users
    description: Registro, autenticaci√≥n y estad√≠sticas de usuario.
  - name: Games
    description: Gesti√≥n de partidas multijugador.
  - name: Questions
    description: Gesti√≥n y consulta de preguntas de trivia.
  - name: AI
    description: Generaci√≥n de preguntas con inteligencia artificial.
  - name: VoiceInteractions
    description: Gesti√≥n de interacciones de voz y modo de accesibilidad.
  - name: VoiceResponses
    description: Procesamiento y validaci√≥n de respuestas por voz.
  - name: AdminAccessibility
    description: Controles administrativos para funcionalidades de accesibilidad.
  - name: TTS
    description: Endpoints de Text-to-Speech y gesti√≥n de voces (Azure/AssemblyAI).
  - name: AssemblyAI
    description: Endpoints para integraci√≥n directa con AssemblyAI (STT/TTS/Procesamiento).
  - name: FacialRecognition
    description: Endpoints para registro y login facial (reconocimiento biom√©trico).
  - name: OCR
    description: Endpoints para reconocimiento √≥ptico de caracteres (OCR).

paths:

  /api/admin/accessibility:
    get:
      tags: [AdminAccessibility]
      summary: Obtener configuraci√≥n de accesibilidad del usuario autenticado
      description: |
        Devuelve la configuraci√≥n de accesibilidad del usuario autenticado.
        **Requiere autenticaci√≥n Firebase.**
        
        ### Ejemplo de uso
        **Local:**
        ```bash
        curl -X GET http://localhost:5000/api/admin/accessibility -H "Authorization: Bearer <TOKEN>"
        ```
        **Producci√≥n:**
        ```bash
        curl -X GET https://backend-v1-latest.onrender.com/api/admin/accessibility -H "Authorization: Bearer <TOKEN>"
        ```
      security:
        - bearerAuth: []
      responses:
        200:
          description: Configuraci√≥n de accesibilidad del usuario.
          content:
            application/json:
              schema:
                type: object
                properties:
                  visualDifficulty:
                    type: boolean
                    example: false
                  stats:
                    type: object
                  email:
                    type: string
                    example: "usuario@ejemplo.com"
                  displayName:
                    type: string
                    example: "Usuario Ejemplo"
              example:
                visualDifficulty: false
                stats: { gamesPlayed: 10, wins: 2, correctAnswers: 30 }
                email: "usuario@ejemplo.com"
                displayName: "Usuario Ejemplo"
        401:
          description: No autenticado.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "No autenticado"
        404:
          description: Usuario no encontrado.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Usuario no encontrado"
        500:
          description: Error interno del servidor.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Error interno del servidor"

    put:
      tags: [AdminAccessibility]
      summary: Actualizar configuraci√≥n de accesibilidad del usuario autenticado
      description: |
        Actualiza la preferencia de accesibilidad visual del usuario autenticado.
        **Requiere autenticaci√≥n Firebase.**
        
        ### Ejemplo de uso
        **Local:**
        ```bash
        curl -X PUT http://localhost:5000/api/admin/accessibility \
          -H "Authorization: Bearer <TOKEN>" \
          -H "Content-Type: application/json" \
          -d '{"visualDifficulty": true}'
        ```
        **Producci√≥n:**
        ```bash
        curl -X PUT https://backend-v1-latest.onrender.com/api/admin/accessibility \
          -H "Authorization: Bearer <TOKEN>" \
          -H "Content-Type: application/json" \
          -d '{"visualDifficulty": true}'
        ```
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                visualDifficulty:
                  type: boolean
                  description: "Indica si el usuario tiene dificultades visuales."
                  example: true
            example:
              visualDifficulty: true
      responses:
        200:
          description: Configuraci√≥n actualizada.
          content:
            application/json:
              schema:
                type: object
                properties:
                  visualDifficulty:
                    type: boolean
                    example: true
                  email:
                    type: string
                    example: "usuario@ejemplo.com"
                  displayName:
                    type: string
                    example: "Usuario Ejemplo"
              example:
                visualDifficulty: true
                email: "usuario@ejemplo.com"
                displayName: "Usuario Ejemplo"
        400:
          description: visualDifficulty debe ser booleano.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "visualDifficulty debe ser booleano"
        401:
          description: No autenticado.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "No autenticado"
        500:
          description: Error interno del servidor.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Error interno del servidor"

  /api/admin/accessibility/stats:
    get:
      tags: [AdminAccessibility]
      summary: Obtener estad√≠sticas de accesibilidad del usuario autenticado
      description: |
        Devuelve estad√≠sticas de interacciones de voz del usuario autenticado.
        **Requiere autenticaci√≥n Firebase.**
        
        ### Ejemplo de uso
        **Local:**
        ```bash
        curl -X GET http://localhost:5000/api/admin/accessibility/stats -H "Authorization: Bearer <TOKEN>"
        ```
        **Producci√≥n:**
        ```bash
        curl -X GET https://backend-v1-latest.onrender.com/api/admin/accessibility/stats -H "Authorization: Bearer <TOKEN>"
        ```
      security:
        - bearerAuth: []
      responses:
        200:
          description: Estad√≠sticas de accesibilidad del usuario.
          content:
            application/json:
              schema:
                type: object
                properties:
                  totalInteractions:
                    type: integer
                    example: 12
                  averageDuration:
                    type: number
                    example: 2.5
              example:
                totalInteractions: 12
                averageDuration: 2.5
        401:
          description: No autenticado.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "No autenticado"
        500:
          description: Error interno del servidor.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Error interno del servidor"

  /api/admin/accessibility-stats:
    get:
      tags: [AdminAccessibility]
      summary: Obtener estad√≠sticas globales de accesibilidad (ADMIN)
      description: |
        Devuelve estad√≠sticas globales de accesibilidad y uso del modo de voz.
        **Requiere autenticaci√≥n Firebase.**
        
        ### Ejemplo de uso
        **Local:**
        ```bash
        curl -X GET http://localhost:5000/api/admin/accessibility-stats -H "Authorization: Bearer <TOKEN>"
        ```
        **Producci√≥n:**
        ```bash
        curl -X GET https://backend-v1-latest.onrender.com/api/admin/accessibility-stats -H "Authorization: Bearer <TOKEN>"
        ```
      security:
        - bearerAuth: []
      responses:
        200:
          description: Estad√≠sticas globales de accesibilidad.
          content:
            application/json:
              schema:
                type: object
                properties:
                  totalUsers:
                    type: integer
                    example: 100
                  usersWithVisualDifficulty:
                    type: integer
                    example: 20
                  voiceModeUsers:
                    type: integer
                    example: 20
                  adoptionRate:
                    type: number
                    example: 20.0
                  totalVoiceInteractions:
                    type: integer
                    example: 300
                  avgVoiceDuration:
                    type: number
                    example: 2.7
                  voiceAnswerCount:
                    type: integer
                    example: 180
                  questionReadCount:
                    type: integer
                    example: 120
                  lastUpdated:
                    type: string
                    example: "2025-10-14T12:00:00.000Z"
              example:
                totalUsers: 100
                usersWithVisualDifficulty: 20
                voiceModeUsers: 20
                adoptionRate: 20.0
                totalVoiceInteractions: 300
                avgVoiceDuration: 2.7
                voiceAnswerCount: 180
                questionReadCount: 120
                lastUpdated: "2025-10-14T12:00:00.000Z"
        401:
          description: No autenticado.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "No autenticado"
        500:
          description: Error interno del servidor.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Error interno del servidor"

  /api/admin/voice-mode-users:
    get:
      tags: [AdminAccessibility]
      summary: Obtener lista de usuarios con modo de voz (ADMIN)
      description: |
        Devuelve la lista de usuarios que tienen activada la preferencia de accesibilidad visual.
        **Requiere autenticaci√≥n Firebase.**
        
        ### Ejemplo de uso
        **Local:**
        ```bash
        curl -X GET http://localhost:5000/api/admin/voice-mode-users -H "Authorization: Bearer <TOKEN>"
        ```
        **Producci√≥n:**
        ```bash
        curl -X GET https://backend-v1-latest.onrender.com/api/admin/voice-mode-users -H "Authorization: Bearer <TOKEN>"
        ```
      security:
        - bearerAuth: []
      responses:
        200:
          description: Lista de usuarios con modo de voz.
          content:
            application/json:
              schema:
                type: object
                properties:
                  total:
                    type: integer
                    example: 3
                  users:
                    type: array
                    items:
                      type: object
                      properties:
                        uid:
                          type: string
                          example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
                        email:
                          type: string
                          example: "usuario@ejemplo.com"
                        displayName:
                          type: string
                          example: "Usuario Ejemplo"
                        visualDifficulty:
                          type: boolean
                          example: true
                        createdAt:
                          type: string
                          example: "2025-10-01T10:00:00.000Z"
                        lastLogin:
                          type: string
                          example: "2025-10-14T09:00:00.000Z"
              example:
                total: 2
                users:
                  - uid: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
                    email: "usuario1@ejemplo.com"
                    displayName: "Usuario Uno"
                    visualDifficulty: true
                    createdAt: "2025-10-01T10:00:00.000Z"
                    lastLogin: "2025-10-14T09:00:00.000Z"
                  - uid: "u1a2b3c4d5e6f7g8h9i0j1k2l3"
                    email: "usuario2@ejemplo.com"
                    displayName: "Usuario Dos"
                    visualDifficulty: true
                    createdAt: "2025-10-02T11:00:00.000Z"
                    lastLogin: "2025-10-14T08:00:00.000Z"
        401:
          description: No autenticado.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "No autenticado"
        500:
          description: Error interno del servidor.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Error interno del servidor"

  /api/voice-interactions:
    post:
      tags: [VoiceInteractions]
      summary: Registrar una nueva interacci√≥n de voz
      description: |
        Registra una interacci√≥n de voz (lectura o respuesta) del usuario.
        **Integraci√≥n completa con AssemblyAI para Speech-to-Text (STT).**
        Si se proporciona audioBase64 en metadata, se procesar√° autom√°ticamente con AssemblyAI.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, questionId, action, duration, timestamp, metadata]
              properties:
                userId:
                  type: string
                  example: "abc123"
                questionId:
                  type: string
                  example: "q789"
                action:
                  type: string
                  enum: [question_read, voice_answer]
                  example: "voice_answer"
                duration:
                  type: number
                  example: 3.2
                timestamp:
                  type: string
                  format: date-time
                  example: "2025-10-10T12:34:56.789Z"
                voiceText:
                  type: string
                  nullable: true
                  example: null
                confidence:
                  type: number
                  nullable: true
                  example: null
                metadata:
                  type: object
                  example: { "audioBase64": "..." }
            example:
              userId: "abc123"
              questionId: "q789"
              action: "voice_answer"
              duration: 3.2
              timestamp: "2025-10-10T12:34:56.789Z"
              voiceText: null
              confidence: null
              metadata:
                audioBase64: "..."
      responses:
        201:
          description: Interacci√≥n registrada correctamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Voice interaction registered successfully."
        400:
          description: Error en los datos enviados.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Missing required fields."
        500:
          description: Error interno del servidor.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Internal server error."

  /api/voice-interactions/{userId}:
    get:
      tags: [VoiceInteractions]
      summary: Obtener historial de interacciones de voz de un usuario
      description: Devuelve el historial completo de interacciones de voz para el usuario indicado.
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Historial de interacciones de voz.
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                    userId:
                      type: string
                    questionId:
                      type: string
                    action:
                      type: string
                    duration:
                      type: number
                    timestamp:
                      type: string
                    voiceText:
                      type: string
                      nullable: true
                    confidence:
                      type: number
                      nullable: true
                    metadata:
                      type: object
              example:
                - id: "docId1"
                  userId: "abc123"
                  questionId: "q789"
                  action: "voice_answer"
                  duration: 3.2
                  timestamp: "2025-10-10T12:34:56.789Z"
                  voiceText: null
                  confidence: null
                  metadata:
                    audioBase64: "..."
        500:
          description: Error interno del servidor.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Internal server error."

    delete:
      tags: [VoiceInteractions]
      summary: Eliminar historial de interacciones de voz de un usuario
      description: Elimina todas las interacciones de voz del usuario indicado.
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Historial eliminado correctamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Deleted 3 interactions."
        500:
          description: Error interno del servidor.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Internal server error."

  /api/voice-interactions/stats/{userId}:
    get:
      tags: [VoiceInteractions]
      summary: Obtener estad√≠sticas b√°sicas de interacciones de voz
      description: Devuelve estad√≠sticas b√°sicas (total, duraci√≥n promedio) de las interacciones de voz del usuario.
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      responses:
        200:
          description: Estad√≠sticas de interacciones de voz.
          content:
            application/json:
              schema:
                type: object
                properties:
                  total:
                    type: integer
                    example: 5
                  averageDuration:
                    type: number
                    example: 2.8
        500:
          description: Error interno del servidor.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Internal server error."

  /api/voice-interactions/process-audio:
    post:
      tags: [VoiceInteractions]
      summary: Procesar audio directamente con AssemblyAI
      description: |
        Procesa un archivo de audio en base64 usando AssemblyAI para obtener transcripci√≥n y validaci√≥n.
        **Integraci√≥n completa con AssemblyAI para Speech-to-Text (STT).**
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [audioBase64]
              properties:
                audioBase64:
                  type: string
                  description: Audio en formato base64 (m√°ximo 2MB)
                  example: "UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBz2J0fPZgjMGHm7A7+OZURE="
                questionOptions:
                  type: array
                  items:
                    type: string
                  description: Opciones de la pregunta para validaci√≥n (opcional)
                  example: ["Opci√≥n A", "Opci√≥n B", "Opci√≥n C", "Opci√≥n D"]
      responses:
        200:
          description: Audio procesado exitosamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  text:
                    type: string
                    example: "primera opci√≥n"
                  confidence:
                    type: number
                    example: 0.95
                  duration:
                    type: number
                    example: 2.5
                  language:
                    type: string
                    example: "es"
                  validation:
                    type: object
                    properties:
                      isValid:
                        type: boolean
                        example: true
                      matchedOption:
                        type: string
                        example: "Opci√≥n A"
                      answerIndex:
                        type: integer
                        example: 0
                      confidence:
                        type: number
                        example: 0.9
                  suggestions:
                    type: array
                    items:
                      type: string
                    example: []
        400:
          description: Datos de entrada inv√°lidos.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Invalid or missing audioBase64."
        413:
          description: Audio demasiado grande.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Audio demasiado grande."
        500:
          description: Error en el procesamiento de audio.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Transcription failed"
                  details:
                    type: string
                    example: "API rate limit exceeded"
                  suggestions:
                    type: array
                    items:
                      type: string
                    example: ["Diga 'A' para Opci√≥n A...", "Diga 'primera opci√≥n'"]

  /api/voice-interactions/assemblyai/status:
    get:
      tags: [VoiceInteractions]
      summary: Verificar estado de AssemblyAI
      description: Verifica el estado y disponibilidad del servicio AssemblyAI.
      responses:
        200:
          description: Estado de AssemblyAI obtenido exitosamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  status:
                    type: string
                    example: "API is working"
                  data:
                    type: object
                    description: Datos adicionales del estado de la API
        500:
          description: Error al verificar el estado de AssemblyAI.
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "API key invalid"

  /api/users/register:
    post:
      tags: [Users]
      summary: Registrar un nuevo usuario
      description: |
        Crea un nuevo usuario en el sistema.  
        **Nota:** El registro tambi√©n crea el usuario en Firebase Auth y en la base de datos de usuarios.
        **Rate Limiting:** M√°ximo 5 intentos de registro por IP cada 15 minutos.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password, displayName]
              properties:
                email:
                  type: string
                  example: "maria.garcia@gmail.com"
                  description: "Correo electr√≥nico √∫nico del usuario. Ejemplo real: maria.garcia@gmail.com"
                password:
                  type: string
                  example: "MiClaveSegura2025!"
                  description: "Contrase√±a segura (m√≠nimo 8 caracteres, may√∫sculas, min√∫sculas y s√≠mbolos)."
                displayName:
                  type: string
                  example: "Maria Garcia"
                  description: "Nombre visible del usuario en el juego."
                visualDifficulty:
                  type: boolean
                  example: false
                  description: "Indica si el usuario tiene dificultades visuales para activar funcionalidades de accesibilidad. Por defecto: false"
            example:
              email: "maria.garcia@gmail.com"
              password: "MiClaveSegura2025!"
              displayName: "Maria Garcia"
              visualDifficulty: false
      responses:
        201:
          description: Usuario registrado correctamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  uid:
                    type: string
                    example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
                    description: "UID generado por Firebase Auth. Ejemplo real: u7d8f9g0h1i2j3k4l5m6n7o8p9"
                  email:
                    type: string
                    example: "maria.garcia@gmail.com"
                  displayName:
                    type: string
                    example: "Maria Garcia"
                  visualDifficulty:
                    type: boolean
                    example: false
                    description: "Preferencia de accesibilidad del usuario"
              example:
                uid: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
                email: "maria.garcia@gmail.com"
                displayName: "Maria Garcia"
                visualDifficulty: false
        400:
          description: Error en el registro (por ejemplo, email ya registrado).
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "El email ya est√° en uso."
              example:
                error: "El email ya est√° en uso."
        429:
          description: Demasiados intentos de registro.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Demasiados intentos de registro. Intenta de nuevo en 15 minutos."
              example:
                error: "Demasiados intentos de registro. Intenta de nuevo en 15 minutos."

  /api/users/me/profile:
    put:
      tags: [Users]
      summary: Actualizar perfil de usuario
      description: |
        Actualiza el perfil del usuario autenticado, incluyendo preferencias de accesibilidad.
        **Requiere:** Token de autenticaci√≥n Firebase en el header Authorization.
        **Rate Limiting:** M√°ximo 10 actualizaciones por IP cada 5 minutos.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                displayName:
                  type: string
                  example: "Maria Garcia Actualizada"
                  description: "Nuevo nombre visible del usuario en el juego."
                visualDifficulty:
                  type: boolean
                  example: true
                  description: "Actualizar preferencia de accesibilidad visual."
            example:
              displayName: "Maria Garcia Actualizada"
              visualDifficulty: true
      responses:
        200:
          description: Perfil actualizado correctamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  uid:
                    type: string
                    example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
                  displayName:
                    type: string
                    example: "Maria Garcia Actualizada"
                  email:
                    type: string
                    example: "maria.garcia@gmail.com"
                  visualDifficulty:
                    type: boolean
                    example: true
                  stats:
                    type: object
                    properties:
                      gamesPlayed:
                        type: integer
                        example: 12
                      wins:
                        type: integer
                        example: 4
                      correctAnswers:
                        type: integer
                        example: 87
              example:
                uid: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
                displayName: "Maria Garcia Actualizada"
                email: "maria.garcia@gmail.com"
                visualDifficulty: true
                stats:
                  gamesPlayed: 12
                  wins: 4
                  correctAnswers: 87
        400:
          description: Error en la actualizaci√≥n (campos inv√°lidos).
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "visualDifficulty must be a boolean value"
              example:
                error: "visualDifficulty must be a boolean value"
        401:
          description: Token de autenticaci√≥n requerido.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Authentication required"
              example:
                error: "Authentication required"
        404:
          description: Usuario no encontrado.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "User not found"
              example:
                error: "User not found"

  /api/users/login:
    post:
      tags: [Users]
      summary: Login de usuario (Referencia)
      description: |
        Este endpoint es solo de referencia.  
        El login real se realiza en el frontend usando Firebase Auth.
      responses:
        501:
          description: Login manejado en el cliente.

  /api/users/recover-password:
    post:
      tags: [Users]
      summary: Recuperar contrase√±a
      description: |
        Env√≠a un correo de recuperaci√≥n de contrase√±a al usuario.
        **Rate Limiting:** M√°ximo 3 intentos de recuperaci√≥n por IP cada 15 minutos.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email]
              properties:
                email:
                  type: string
                  example: "maria.garcia@gmail.com"
            example:
              email: "maria.garcia@gmail.com"
      responses:
        200:
          description: Email de recuperaci√≥n enviado.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Se ha enviado un correo de recuperaci√≥n a maria.garcia@gmail.com."
              example:
                message: "Se ha enviado un correo de recuperaci√≥n a maria.garcia@gmail.com."
        400:
          description: Error al enviar email.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "No se pudo enviar el correo."
              example:
                error: "No se pudo enviar el correo."

  /api/users/me/stats:
    get:
      tags: [Users]
      summary: Obtener estad√≠sticas del usuario
      description: |
        Devuelve las estad√≠sticas del usuario autenticado.  
        **Requiere:** UID del usuario como par√°metro de consulta.
      parameters:
        - in: query
          name: uid
          schema:
            type: string
          required: true
          description: UID del usuario (lo obtienes tras el login).
          example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
      responses:
        200:
          description: Estad√≠sticas del usuario encontradas.
          content:
            application/json:
              schema:
                type: object
                properties:
                  uid:
                    type: string
                    example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
                  stats:
                    type: object
                    properties:
                      gamesPlayed:
                        type: integer
                        example: 12
                        description: "N√∫mero total de partidas jugadas por el usuario."
                      wins:
                        type: integer
                        example: 4
                        description: "Partidas ganadas por el usuario."
                      correctAnswers:
                        type: integer
                        example: 87
                        description: "Total de respuestas correctas."
                  visualDifficulty:
                    type: boolean
                    example: false
                    description: "Preferencia de accesibilidad del usuario"
              example:
                uid: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
                stats:
                  gamesPlayed: 12
                  wins: 4
                  correctAnswers: 87
                visualDifficulty: false
        404:
          description: Usuario no encontrado.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "User not found"
              example:
                error: "User not found"

  /api/users/me/history:
    get:
      tags: [Users]
      summary: (Deshabilitado) Historial de partidas
      description: |
        Este endpoint est√° deshabilitado y siempre devuelve un array vac√≠o.
      responses:
        200:
          description: Historial vac√≠o.
          content:
            application/json:
              schema:
                type: array
                items: {}
              example: []

  /api/games:
    get:
      tags: [Games]
      summary: Listar partidas p√∫blicas disponibles
      description: |
        Devuelve todas las partidas p√∫blicas que est√°n esperando jugadores.
      responses:
        200:
          description: Lista de partidas p√∫blicas.
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      example: "game_20250918_001"
                      description: "ID √∫nico de la partida. Ejemplo real: game_20250918_001"
                    isPublic:
                      type: boolean
                      example: true
                      description: "Si la partida es p√∫blica (cualquiera puede unirse)."
                    status:
                      type: string
                      example: "waiting"
                      description: "Estado de la partida (waiting, started, finished)."
                    players:
                      type: array
                      items:
                        type: object
                        properties:
                          uid:
                            type: string
                            example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
                          displayName:
                            type: string
                            example: "Maria Garcia"
                      description: "Lista de jugadores en la partida."
                    topic:
                      type: string
                      example: "Cultura General"
                      description: "Tema principal de la partida."
                    questions:
                      type: array
                      items:
                        $ref: '#/components/schemas/Question'
                      description: "Preguntas asignadas a la partida."
              example:
                - id: "game_20250918_001"
                  isPublic: true
                  status: "waiting"
                  players:
                    - uid: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
                      displayName: "Maria Garcia"
                    - uid: "u1a2b3c4d5e6f7g8h9i0j1k2l3"
                      displayName: "Carlos Perez"
                  topic: "Cultura General"
                  questions:
                    - text: "¬øCu√°l es el r√≠o m√°s largo del mundo?"
                      options: ["Nilo", "Amazonas", "Yangts√©", "Misisipi"]
                      correctAnswerIndex: 1
                      category: "Geograf√≠a"
                      difficulty: "medium"
                      explanation: "El r√≠o Amazonas es el m√°s largo del mundo, superando al Nilo en longitud total."

  /api/questions:
    get:
      tags: [Questions]
      summary: Obtener todas las preguntas
      description: |
        Devuelve todas las preguntas almacenadas en la base de datos.
      responses:
        200:
          description: Lista de preguntas.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Question'
              example:
                - text: "¬øCu√°l es el r√≠o m√°s largo del mundo?"
                  options: ["Nilo", "Amazonas", "Yangts√©", "Misisipi"]
                  correctAnswerIndex: 1
                  category: "Geograf√≠a"
                  difficulty: "medium"
                  explanation: "El r√≠o Amazonas es el m√°s largo del mundo, superando al Nilo en longitud total."
                - text: "¬øQui√©n escribi√≥ 'Cien a√±os de soledad'?"
                  options: ["Mario Vargas Llosa", "Gabriel Garc√≠a M√°rquez", "Julio Cort√°zar", "Isabel Allende"]
                  correctAnswerIndex: 1
                  category: "Literatura"
                  difficulty: "easy"
                  explanation: "Gabriel Garc√≠a M√°rquez es el autor de 'Cien a√±os de soledad'."

    post:
      tags: [Questions]
      summary: Crear una nueva pregunta
      description: |
        Crea una pregunta manualmente.  
        **Ejemplo de cuerpo:**
        ```
        {
          "text": "¬øCu√°l es la capital de Francia?",
          "options": ["Madrid", "Par√≠s", "Roma", "Berl√≠n"],
          "correctAnswerIndex": 1,
          "category": "Geograf√≠a",
          "difficulty": "easy",
          "explanation": "Par√≠s es la capital de Francia."
        }
        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Question'
            example:
              text: "¬øQui√©n escribi√≥ 'Cien a√±os de soledad'?"
              options: ["Mario Vargas Llosa", "Gabriel Garc√≠a M√°rquez", "Julio Cort√°zar", "Isabel Allende"]
              correctAnswerIndex: 1
              category: "Literatura"
              difficulty: "easy"
              explanation: "Gabriel Garc√≠a M√°rquez es el autor de 'Cien a√±os de soledad'."
      responses:
        201:
          description: Pregunta creada.
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    example: "question123"
              example:
                id: "question123"
        400:
          description: Error al crear pregunta.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Faltan campos obligatorios."
              example:
                error: "Faltan campos obligatorios."

  /api/questions/bulk:
    post:
      tags: [Questions]
      summary: Crear varias preguntas en lote
      description: |
        Permite crear varias preguntas a la vez (por ejemplo, tras generar con IA).
        **Ejemplo de cuerpo:**
        ```
        {
          "questions": [
            {
              "text": "¬øCu√°l es la capital de Francia?",
              "options": ["Madrid", "Par√≠s", "Roma", "Berl√≠n"],
              "correctAnswerIndex": 1,
              "category": "Geograf√≠a",
              "difficulty": "easy",
              "explanation": "Par√≠s es la capital de Francia."
            },
            {
              "text": "¬øQui√©n pint√≥ la Mona Lisa?",
              "options": ["Van Gogh", "Picasso", "Da Vinci", "Rembrandt"],
              "correctAnswerIndex": 2,
              "category": "Arte",
              "difficulty": "medium",
              "explanation": "Leonardo da Vinci pint√≥ la Mona Lisa."
            }
          ]
        }
        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                questions:
                  type: array
                  items:
                    $ref: '#/components/schemas/Question'
            example:
              questions:
                - text: "¬øCu√°l es el r√≠o m√°s largo del mundo?"
                  options: ["Nilo", "Amazonas", "Yangts√©", "Misisipi"]
                  correctAnswerIndex: 1
                  category: "Geograf√≠a"
                  difficulty: "medium"
                  explanation: "El r√≠o Amazonas es el m√°s largo del mundo, superando al Nilo en longitud total."
                - text: "¬øQui√©n escribi√≥ 'Cien a√±os de soledad'?"
                  options: ["Mario Vargas Llosa", "Gabriel Garc√≠a M√°rquez", "Julio Cort√°zar", "Isabel Allende"]
                  correctAnswerIndex: 1
                  category: "Literatura"
                  difficulty: "easy"
                  explanation: "Gabriel Garc√≠a M√°rquez es el autor de 'Cien a√±os de soledad'."
      responses:
        200:
          description: Preguntas creadas exitosamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
              example:
                success: true
        400:
          description: Error al crear preguntas.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "No questions provided"
              example:
                error: "No questions provided"

  /api/questions/{id}:
    put:
      tags: [Questions]
      summary: Actualizar una pregunta existente
      description: |
        Actualiza una pregunta por su ID.
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: ID de la pregunta a actualizar.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Question'
            example:
              text: "¬øQui√©n escribi√≥ 'Cien a√±os de soledad'?"
              options: ["Mario Vargas Llosa", "Gabriel Garc√≠a M√°rquez", "Julio Cort√°zar", "Isabel Allende"]
              correctAnswerIndex: 1
              category: "Literatura"
              difficulty: "easy"
              explanation: "Gabriel Garc√≠a M√°rquez es el autor de 'Cien a√±os de soledad'."
      responses:
        200:
          description: Pregunta actualizada.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Question updated"
              example:
                message: "Question updated"
        400:
          description: Error al actualizar pregunta.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Pregunta no encontrada."
              example:
                error: "Pregunta no encontrada."

    delete:
      tags: [Questions]
      summary: Eliminar una pregunta
      description: |
        Elimina una pregunta por su ID.
      parameters:
        - in: path
          name: id
          schema:
            type: string
          required: true
          description: ID de la pregunta a eliminar.
      responses:
        200:
          description: Pregunta eliminada.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Question deleted"
              example:
                message: "Question deleted"
        400:
          description: Error al eliminar pregunta.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Pregunta no encontrada."
              example:
                error: "Pregunta no encontrada."

  /api/ai/generate-questions:
    post:
      tags: [AI]
      summary: Generar preguntas con IA
      description: |
        Genera preguntas de trivia usando inteligencia artificial (Groq/OpenAI).  
        **Requiere:** API Key configurada en el backend.
        **Ejemplo de cuerpo:**
        ```
        {
          "topic": "Ciencia",
          "difficulty": "medium",
          "count": 3,
          "useAI": true
        }
        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [topic, difficulty, count, useAI]
              properties:
                topic:
                  type: string
                  example: "Ciencia"
                difficulty:
                  type: string
                  example: "medium"
                count:
                  type: integer
                  example: 3
                useAI:
                  type: boolean
                  example: true
            example:
              topic: "Ciencia"
              difficulty: "medium"
              count: 3
              useAI: true
      responses:
        200:
          description: Preguntas generadas exitosamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  topic:
                    type: string
                    example: "Ciencia"
                  difficulty:
                    type: string
                    example: "medium"
                  count:
                    type: integer
                    example: 3
                  questions:
                    type: array
                    items:
                      $ref: '#/components/schemas/Question'
              example:
                success: true
                topic: "Ciencia"
                difficulty: "medium"
                count: 3
                questions:
                  - text: "¬øCu√°l es el elemento qu√≠mico con s√≠mbolo 'O'?"
                    options: ["Oro", "Ox√≠geno", "Osmio", "Oxalato"]
                    correctAnswerIndex: 1
                    category: "Ciencia"
                    difficulty: "easy"
                    explanation: "El s√≠mbolo 'O' corresponde al Ox√≠geno."
                  - text: "¬øQui√©n propuso la teor√≠a de la relatividad?"
                    options: ["Isaac Newton", "Albert Einstein", "Marie Curie", "Niels Bohr"]
                    correctAnswerIndex: 1
                    category: "Ciencia"
                    difficulty: "medium"
                    explanation: "Albert Einstein propuso la teor√≠a de la relatividad."
        400:
          description: Error en la generaci√≥n de preguntas.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Debes activar el modo IA para generar preguntas."
              example:
                error: "Debes activar el modo IA para generar preguntas."

  /api/ai/topics:
    get:
      tags: [AI]
      summary: Obtener lista de temas disponibles para preguntas IA
      description: |
        Devuelve una lista de temas que puedes usar para generar preguntas con IA.
      responses:
        200:
          description: Lista de temas.
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  topics:
                    type: array
                    items:
                      type: string
                    example: ["Ciencia", "Historia", "Geograf√≠a"]
              example:
                success: true
                topics: ["Ciencia", "Historia", "Geograf√≠a", "Arte", "Deportes"]

  /api/ai/difficulty-levels:
    get:
      tags: [AI]
      summary: Obtener niveles de dificultad disponibles
      description: |
        Devuelve los niveles de dificultad soportados por la IA.
      responses:
        200:
          description: Lista de niveles de dificultad.
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  levels:
                    type: array
                    items:
                      type: object
                      properties:
                        value:
                          type: string
                          example: "easy"
                        label:
                          type: string
                          example: "F√°cil"
              example:
                success: true
                levels:
                  - value: "easy"
                    label: "F√°cil"
                  - value: "medium"
                    label: "Intermedio"
                  - value: "hard"
                    label: "Dif√≠cil"

  /api/ai/generate-game-questions:
    post:
      tags: [AI]
      summary: Generar preguntas IA para una partida espec√≠fica
      description: |
        Genera preguntas usando IA y las devuelve asociadas a un gameId. Usado para poblar partidas.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [gameId, topic, count]
              properties:
                gameId:
                  type: string
                  example: "123456"
                topic:
                  type: string
                  example: "Historia"
                difficulty:
                  type: string
                  example: "medium"
                count:
                  type: integer
                  example: 10
            example:
              gameId: "123456"
              topic: "Historia"
              difficulty: "medium"
              count: 10
      responses:
        200:
          description: Preguntas generadas para la partida
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  gameId:
                    type: string
                    example: "123456"
                  questions:
                    type: array
                    items:
                      $ref: '#/components/schemas/Question'
        400:
          description: Datos inv√°lidos
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "gameId y topic son requeridos"

  /api/games/{gameId}:
    delete:
      tags: [Games]
      summary: Eliminar una partida p√∫blica (solo creador)
      description: Elimina una partida p√∫blica por su ID. Requiere autenticaci√≥n y que el usuario sea el creador.
      security:
        - bearerAuth: []
      parameters:
        - name: gameId
          in: path
          required: true
          schema:
            type: string
          description: ID de la partida a eliminar
      responses:
        200:
          description: Partida eliminada correctamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Game deleted successfully"
        403:
          description: No autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "You are not authorized to delete this game"
        404:
          description: Partida no encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Game not found"

  /api/tts/synthesize:
    post:
      tags: [TTS]
      summary: Sintetizar texto a audio (TTS)
      description: |
        Convierte texto en audio usando el servicio de TTS configurado (Azure/AssemblyAI).
        Requiere autenticaci√≥n en las rutas del controlador (ruta `/api/tts` la aplica).
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [text]
              properties:
                text:
                  type: string
                  example: "Hola, bienvenido a BrainBlitz"
                options:
                  type: object
                  description: Opciones para s√≠ntesis (voice, speed, format)
            example:
              text: "Hola, bienvenido a BrainBlitz"
              options: { voice: "es-ES-EnriqueNeural", speed: 1.0 }
      responses:
        200:
          description: Audio sintetizado (respuesta binaria o metadata)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
        400:
          description: Petici√≥n inv√°lida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        500:
          description: Error interno del servidor

  /api/tts/voices:
    get:
      tags: [TTS]
      summary: Obtener voces disponibles para TTS
      description: Devuelve la lista de voces soportadas por el servicio TTS configurado.
      security:
        - bearerAuth: []
      responses:
        200:
          description: Lista de voces
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    name:
                      type: string
                    locale:
                      type: string
        500:
          description: Error al obtener voces

  /api/assemblyai/tts:
    post:
      tags: [AssemblyAI]
      summary: Text-to-Speech (AssemblyAI)
      description: Sintetiza texto usando AssemblyAI (o servicio configurado).
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [text]
              properties:
                text:
                  type: string
                voice:
                  type: string
                speed:
                  type: number
                format:
                  type: string
            example:
              text: "Hola"
              voice: "es-ES-EnriqueNeural"
      responses:
        200:
          description: Audio devuelto o metadata
        400:
          description: Parametros inv√°lidos

  /api/assemblyai/stt:
    post:
      tags: [AssemblyAI]
      summary: Speech-to-Text (AssemblyAI)
      description: Transcribe audio desde una URL p√∫blica usando AssemblyAI.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [audioUrl]
              properties:
                audioUrl:
                  type: string
                language:
                  type: string
            example:
              audioUrl: "https://.../audio.wav"
              language: "es"
      responses:
        200:
          description: Transcripci√≥n devuelta
        400:
          description: Parametros inv√°lidos

  /api/assemblyai/process-audio:
    post:
      tags: [AssemblyAI]
      summary: Procesar audio en base64 con AssemblyAI
      description: Procesa audio en base64 para transcripci√≥n y validaci√≥n.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [audioBase64]
              properties:
                audioBase64:
                  type: string
                mimeType:
                  type: string
                questionOptions:
                  type: array
                  items:
                    type: string
      responses:
        200:
          description: Resultado de transcripci√≥n y validaci√≥n
        400:
          description: Entrada inv√°lida
        413:
          description: Audio demasiado grande

  /api/assemblyai/voices:
    get:
      tags: [AssemblyAI]
      summary: Obtener voces disponibles en AssemblyAI
      responses:
        200:
          description: Lista de voces
        500:
          description: Error al obtener voces

  /api/assemblyai/status:
    get:
      tags: [AssemblyAI]
      summary: Verificar estado de AssemblyAI
      responses:
        200:
          description: Estado del servicio
        500:
          description: Error al verificar el servicio

  /api/admin/accessibility-settings:
    get:
      tags: [AdminAccessibility]
      summary: Obtener configuraci√≥n global de accesibilidad (ADMIN)
      description: Devuelve la configuraci√≥n global de accesibilidad del sistema.
      security:
        - bearerAuth: []
      responses:
        200:
          description: Configuraci√≥n global devuelta
        401:
          description: No autenticado

    put:
      tags: [AdminAccessibility]
      summary: Actualizar configuraci√≥n global de accesibilidad (ADMIN)
      description: Actualiza la configuraci√≥n global de accesibilidad.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                voiceModeEnabled:
                  type: boolean
                maxAudioSize:
                  type: number
      responses:
        200:
          description: Configuraci√≥n actualizada
        400:
          description: Datos inv√°lidos

  /api/admin/accessibility-report:
    get:
      tags: [AdminAccessibility]
      summary: Generar reporte de accesibilidad (ADMIN)
      description: Devuelve un reporte de uso y accesibilidad para un rango de fechas opcional.
      security:
        - bearerAuth: []
      parameters:
        - name: startDate
          in: query
          schema:
            type: string
        - name: endDate
          in: query
          schema:
            type: string
      responses:
        200:
          description: Reporte generado
        400:
          description: Par√°metros inv√°lidos

  /api/health:
    get:
      tags: [TTS]
      summary: Estado de salud del servidor
      description: Endpoint de prueba para verificar que el servidor est√° activo.
      responses:
        200:
          description: Estado OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "ok"
                  services:
                    type: array
                    items:
                      type: string
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: "Token JWT de Firebase Auth"
  schemas:
    Question:
      type: object
      required: [text, options, correctAnswerIndex, category, difficulty, explanation]
      properties:
        text:
          type: string
          description: "Texto de la pregunta. Ejemplo real: ¬øCu√°l es el r√≠o m√°s largo del mundo?"
          example: "¬øCu√°l es el r√≠o m√°s largo del mundo?"
        options:
          type: array
          description: "Opciones de respuesta. Ejemplo real: [Nilo, Amazonas, Yangts√©, Misisipi]"
          items:
            type: string
          example: ["Nilo", "Amazonas", "Yangts√©", "Misisipi"]
        correctAnswerIndex:
          type: integer
          description: "√çndice de la opci√≥n correcta (en el ejemplo, Amazonas)."
          example: 1
        category:
          type: string
          description: "Categor√≠a o tema de la pregunta. Ejemplo real: Geograf√≠a"
          example: "Geograf√≠a"
        difficulty:
          type: string
          description: "Dificultad de la pregunta (easy, medium, hard). Ejemplo real: medium"
          example: "medium"
        explanation:
          type: string
          description: "Explicaci√≥n de la respuesta correcta. Ejemplo real: El r√≠o Amazonas es el m√°s largo del mundo, superando al Nilo en longitud total."
          example: "El r√≠o Amazonas es el m√°s largo del mundo, superando al Nilo en longitud total."
        createdBy:
          type: string
          description: "UID del creador de la pregunta. Ejemplo real: u7d8f9g0h1i2j3k4l5m6n7o8p9"
          example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
        createdAt:
          type: integer
          description: "Timestamp de creaci√≥n en milisegundos. Ejemplo real: 1758172800000 (18 septiembre 2025)"
          example: 1758172800000

    # ===========================================
    # SCHEMAS DE VOZ Y ACCESIBILIDAD (HU8)
    # ===========================================
    VoiceAnswerEvent:
      type: object
      description: "Evento WebSocket para respuesta de voz"
      properties:
        gameId:
          type: string
          description: "ID del juego"
          example: "123456"
        uid:
          type: string
          description: "ID del usuario"
          example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
        voiceResponse:
          type: string
          description: "Respuesta de voz"
          example: "primera opci√≥n"
        questionOptions:
          type: array
          items:
            type: string
          description: "Opciones de la pregunta"
          example: ["Opci√≥n A", "Opci√≥n B", "Opci√≥n C", "Opci√≥n D"]

    VoiceModeToggleEvent:
      type: object
      description: "Evento WebSocket para activar/desactivar modo de voz"
      properties:
        gameId:
          type: string
          description: "ID del juego"
          example: "123456"
        uid:
          type: string
          description: "ID del usuario"
          example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
        voiceModeEnabled:
          type: boolean
          description: "Estado del modo de voz"
          example: true

    VoiceAnswerReceivedEvent:
      type: object
      description: "Evento WebSocket cuando se recibe una respuesta de voz"
      properties:
        uid:
          type: string
          description: "ID del usuario"
          example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
        confidence:
          type: number
          description: "Confianza del reconocimiento"
          example: 0.9
        matchedOption:
          type: string
          description: "Opci√≥n reconocida"
          example: "Opci√≥n A"

    VoiceModeChangedEvent:
      type: object
      description: "Evento WebSocket cuando cambia el modo de voz de un jugador"
      properties:
        uid:
          type: string
          description: "ID del usuario"
          example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
        voiceModeEnabled:
          type: boolean
          description: "Nuevo estado del modo de voz"
          example: true
        players:
          type: array
          items:
            type: object
            properties:
              uid:
                type: string
                example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
              displayName:
                type: string
                example: "Usuario Test"
              voiceModeEnabled:
                type: boolean
                example: true
          description: "Lista actualizada de jugadores con sus estados de modo de voz"

    VoiceModeStatusEvent:
      type: object
      description: "Evento WebSocket con el estado del modo de voz de todos los jugadores"
      properties:
        players:
          type: array
          items:
            type: object
            properties:
              uid:
                type: string
                example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
              displayName:
                type: string
                example: "Usuario Test"
              voiceModeEnabled:
                type: boolean
                example: true
          description: "Lista de jugadores con sus estados de modo de voz"

  # ===========================================
  # ENDPOINTS DE VOZ Y ACCESIBILIDAD (HU8)
  # ===========================================

  /api/voice-responses/validate:
    post:
      tags: [VoiceResponses]
      summary: Validar respuesta de voz
      description: |
        Valida una respuesta de voz contra las opciones de una pregunta.
        Utiliza algoritmos de coincidencia inteligente para reconocer respuestas habladas.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, questionId, voiceResponse, questionOptions]
              properties:
                userId:
                  type: string
                  description: "ID del usuario que respondi√≥"
                  example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
                questionId:
                  type: string
                  description: "ID de la pregunta"
                  example: "q123456"
                voiceResponse:
                  type: string
                  description: "Texto reconocido de la respuesta de voz"
                  example: "primera opci√≥n"
                questionOptions:
                  type: array
                  items:
                    type: string
                  description: "Opciones de respuesta de la pregunta"
                  example: ["Madrid", "Barcelona", "Valencia", "Sevilla"]
                gameId:
                  type: string
                  description: "ID del juego (opcional)"
                  example: "123456"
      responses:
        '200':
          description: "Respuesta validada exitosamente"
          content:
            application/json:
              schema:
                type: object
                properties:
                  valid:
                    type: boolean
                    description: "Si la respuesta es v√°lida"
                    example: true
                  matchedOption:
                    type: string
                    description: "Opci√≥n que coincidi√≥ con la respuesta"
                    example: "Madrid"
                  confidence:
                    type: number
                    description: "Nivel de confianza (0.0 - 1.0)"
                    example: 0.9
                  answerIndex:
                    type: integer
                    description: "√çndice de la opci√≥n seleccionada"
                    example: 0
        '400':
          description: "Error en la validaci√≥n"
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Missing required fields: userId, questionId, voiceResponse"

  /api/voice-responses/process:
    post:
      tags: [VoiceResponses]
      summary: Procesar respuesta de voz
      description: |
        Procesa una respuesta de voz y la convierte al formato de juego.
        Incluye validaci√≥n y registro de la interacci√≥n.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [userId, questionId, voiceResponse, questionOptions]
              properties:
                userId:
                  type: string
                  description: "ID del usuario"
                  example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
                questionId:
                  type: string
                  description: "ID de la pregunta"
                  example: "q123456"
                voiceResponse:
                  type: string
                  description: "Texto de la respuesta de voz"
                  example: "A"
                questionOptions:
                  type: array
                  items:
                    type: string
                  description: "Opciones de la pregunta"
                  example: ["Opci√≥n A", "Opci√≥n B", "Opci√≥n C", "Opci√≥n D"]
                gameId:
                  type: string
                  description: "ID del juego"
                  example: "123456"
      responses:
        '200':
          description: "Respuesta procesada exitosamente"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  answerIndex:
                    type: integer
                    description: "√çndice de la respuesta"
                    example: 0
                  answerValue:
                    type: string
                    description: "Valor de la respuesta"
                    example: "Opci√≥n A"
                  confidence:
                    type: number
                    description: "Confianza del reconocimiento"
                    example: 0.9
        '400':
          description: "Error en el procesamiento"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "No se pudo reconocer la respuesta de voz"
                  suggestions:
                    type: array
                    items:
                      type: string
                    example: ["Diga 'A' para Opci√≥n A...", "Diga 'primera opci√≥n'"]

  /api/voice-responses/stats/{userId}:
    get:
      tags: [VoiceResponses]
      summary: Obtener estad√≠sticas de reconocimiento de voz
      description: |
        Obtiene estad√≠sticas detalladas del reconocimiento de voz para un usuario.
        Incluye precisi√≥n, confianza promedio y historial reciente.
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
          description: "ID del usuario"
          example: "u7d8f9g0h1i2j3k4l5m6n7o8p9"
      responses:
        '200':
          description: "Estad√≠sticas obtenidas exitosamente"
          content:
            application/json:
              schema:
                type: object
                properties:
                  totalAttempts:
                    type: integer
                    description: "Total de intentos de reconocimiento"
                    example: 25
                  successfulRecognitions:
                    type: integer
                    description: "Reconocimientos exitosos"
                    example: 22
                  accuracy:
                    type: number
                    description: "Precisi√≥n en porcentaje"
                    example: 88.0
                  averageConfidence:
                    type: number
                    description: "Confianza promedio"
                    example: 0.85
                  recentInteractions:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          example: "vi123456"
                        questionId:
                          type: string
                          example: "q123456"
                        voiceText:
                          type: string
                          example: "primera opci√≥n"
                        confidence:
                          type: number
                          example: 0.9
                        isValid:
                          type: boolean
                          example: true
                        timestamp:
                          type: string
                          format: date-time
                          example: "2024-10-15T10:30:00Z"
        '400':
          description: "Error en la solicitud"
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "userId is required"

  # ========================================
  # OCR - OPTICAL CHARACTER RECOGNITION
  # ========================================

  /api/ocr/health:
    get:
      tags: [OCR]
      summary: Verificar estado del servicio OCR
      description: |
        Verifica si el servicio de OCR (Azure) est√° configurado y disponible.
      responses:
        '200':
          description: "Estado del servicio OCR"
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "healthy"
                  service:
                    type: string
                    example: "Azure OCR"
                  available:
                    type: boolean
                    example: true

  /api/ocr/process-url:
    post:
      tags: [OCR]
      summary: Procesar imagen desde URL
      description: |
        Extrae texto de una imagen proporcionada mediante URL.
        √ötil para escanear preguntas desde im√°genes en la web.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                imageUrl:
                  type: string
                  format: uri
                  description: "URL de la imagen a procesar"
                  example: "https://example.com/image.jpg"
                language:
                  type: string
                  description: "C√≥digo de idioma (ej: es, en, fr)"
                  example: "es"
      responses:
        '200':
          description: "Texto extra√≠do exitosamente"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  rawText:
                    type: string
                    example: "¬øCu√°l es la capital de Francia? a) Par√≠s b) Lyon c) Marsella"
                  pregunta:
                    type: string
                    example: "¬øCu√°l es la capital de Francia?"
                  opciones:
                    type: array
                    items:
                      type: string
                    example: ["Par√≠s", "Lyon", "Marsella"]
                  confidence:
                    type: string
                    enum: ["high", "medium", "low"]
                    example: "high"
        '400':
          description: "URL inv√°lida o imagen sin texto"
        '503':
          description: "Servicio OCR no configurado"

  /api/ocr/process-image:
    post:
      tags: [OCR]
      summary: Procesar imagen desde base64
      description: |
        Extrae texto de una imagen proporcionada en formato base64.
        √ötil para im√°genes capturadas desde c√°mara del dispositivo.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                imageBase64:
                  type: string
                  description: "Imagen en base64 (puede incluir prefijo data:image/...)"
                  example: "iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg=="
                mimeType:
                  type: string
                  description: "Tipo MIME (ej: image/jpeg, image/png)"
                  example: "image/jpeg"
                language:
                  type: string
                  description: "C√≥digo de idioma"
                  example: "es"
      responses:
        '200':
          description: "Texto extra√≠do de la imagen"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  rawText:
                    type: string
                  pregunta:
                    type: string
                  opciones:
                    type: array
                    items:
                      type: string
                  confidence:
                    type: string
        '400':
          description: "Base64 inv√°lido o imagen excede l√≠mite (50MB)"
        '503':
          description: "Servicio OCR no configurado"

  # ========================================
  # FACIAL RECOGNITION
  # ========================================

  /api/face/register:
    post:
      tags: [FacialRecognition]
      summary: Registrar cara del usuario
      description: |
        Registra el reconocimiento facial del usuario para login biom√©trico futuro.
        Requiere imagen en base64 y token de Firebase.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                image:
                  type: string
                  description: "Imagen de la cara en base64"
                token:
                  type: string
                  description: "Token de Firebase Auth"
      responses:
        '200':
          description: "Cara registrada exitosamente"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Facial recognition registered successfully"
                  userId:
                    type: string
                    example: "user123456"
        '400':
          description: "Imagen inv√°lida o token faltante"
        '503':
          description: "Servicio facial no disponible"

  /api/face/login:
    post:
      tags: [FacialRecognition]
      summary: Login mediante reconocimiento facial
      description: |
        Autentica al usuario utilizando reconocimiento facial.
        Proporciona imagen y email del usuario.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                image:
                  type: string
                  description: "Imagen de la cara en base64"
                email:
                  type: string
                  format: email
                  description: "Email del usuario a verificar"
      responses:
        '200':
          description: "Login facial exitoso"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Facial login successful"
                  userId:
                    type: string
                  token:
                    type: string
                    description: "JWT token para sesi√≥n"
        '401':
          description: "Cara no reconocida o email no encontrado"
        '503':
          description: "Servicio facial no disponible"

  /api/face/exists:
    get:
      tags: [FacialRecognition]
      summary: Verificar si usuario tiene registro facial
      description: |
        Comprueba si el usuario autenticado tiene un registro facial previo.
        Requiere token de Firebase.
      security:
        - bearerAuth: []
      responses:
        '200':
          description: "Estado del registro facial"
          content:
            application/json:
              schema:
                type: object
                properties:
                  exists:
                    type: boolean
                    example: true
                  userId:
                    type: string
        '401':
          description: "No autenticado"
        '503':
          description: "Servicio facial no disponible"

  /api/face/{userId}:
    delete:
      tags: [FacialRecognition]
      summary: Eliminar registro facial del usuario
      description: |
        Elimina el registro facial del usuario autenticado.
        El uid en el token debe coincidir con el userId en la URL.
      security:
        - bearerAuth: []
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
          description: "ID del usuario (debe coincidir con token)"
      responses:
        '200':
          description: "Registro facial eliminado"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
        '403':
          description: "No autorizado (uid no coincide)"
        '401':
          description: "No autenticado"

  # ========================================
  # ASSEMBLYAI - ADVANCED VOICE PROCESSING
  # ========================================

  /api/assemblyai/tts:
    post:
      tags: [AssemblyAI]
      summary: Text-to-Speech con AssemblyAI
      description: |
        Convierte texto a audio usando AssemblyAI.
        Soporta m√∫ltiples idiomas y voces personalizadas.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                text:
                  type: string
                  description: "Texto a convertir en audio"
                  example: "Bienvenido a BrainBlitz"
                voice:
                  type: string
                  description: "Voz a utilizar"
                  example: "maya"
                language:
                  type: string
                  description: "C√≥digo de idioma"
                  example: "es"
      responses:
        '200':
          description: "Audio generado exitosamente"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  audioUrl:
                    type: string
                    description: "URL del audio generado"
                  duration:
                    type: number
                    description: "Duraci√≥n en segundos"
        '400':
          description: "Texto o par√°metros inv√°lidos"
        '503':
          description: "Servicio AssemblyAI no disponible"

  /api/assemblyai/stt:
    post:
      tags: [AssemblyAI]
      summary: Speech-to-Text con AssemblyAI
      description: |
        Convierte audio a texto usando AssemblyAI.
        Proporciona transcripci√≥n con alta precisi√≥n.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                audioUrl:
                  type: string
                  format: uri
                  description: "URL del audio a transcribir"
                language:
                  type: string
                  example: "es"
                punctuate:
                  type: boolean
                  description: "Agregar puntuaci√≥n autom√°tica"
                  example: true
                speakerLabels:
                  type: boolean
                  description: "Detectar m√∫ltiples hablantes"
      responses:
        '200':
          description: "Transcripci√≥n completada"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  text:
                    type: string
                    example: "Primera opci√≥n"
                  confidence:
                    type: number
                    example: 0.95
        '400':
          description: "URL de audio inv√°lida"
        '503':
          description: "Servicio AssemblyAI no disponible"

  /api/assemblyai/process-audio:
    post:
      tags: [AssemblyAI]
      summary: Procesar audio base64
      description: |
        Procesa audio en formato base64 directamente.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                audioBase64:
                  type: string
                  description: "Audio en base64"
                mimeType:
                  type: string
                  example: "audio/wav"
                language:
                  type: string
                  example: "es"
      responses:
        '200':
          description: "Audio procesado"

  /api/assemblyai/voices:
    get:
      tags: [AssemblyAI]
      summary: Obtener voces disponibles
      description: |
        Lista todas las voces disponibles en AssemblyAI.
      security:
        - bearerAuth: []
      responses:
        '200':
          description: "Lista de voces"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  voices:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        name:
                          type: string
                        language:
                          type: string

  /api/assemblyai/status:
    get:
      tags: [AssemblyAI]
      summary: Estado del servicio AssemblyAI
      description: |
        Verifica disponibilidad del servicio AssemblyAI.
      responses:
        '200':
          description: "Estado del servicio"
          content:
            application/json:
              schema:
                type: object
                properties:
                  available:
                    type: boolean
                  service:
                    type: string
                    example: "AssemblyAI"
                  features:
                    type: array
                    items:
                      type: string

  # ========================================
  # AI - ARTIFICIAL INTELLIGENCE ENDPOINTS
  # ========================================

  /api/ai/topics:
    get:
      tags: [AI]
      summary: Obtener temas disponibles
      description: |
        Retorna la lista de temas disponibles para generar preguntas con IA.
        **Rate limited**
      responses:
        '200':
          description: "Lista de temas disponibles"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  topics:
                    type: array
                    items:
                      type: string
                    example: ["ciencia", "historia", "geograf√≠a", "tecnolog√≠a", "deporte"]

  /api/ai/difficulty-levels:
    get:
      tags: [AI]
      summary: Obtener niveles de dificultad
      description: |
        Retorna los niveles de dificultad disponibles para generar preguntas.
        **Rate limited**
      responses:
        '200':
          description: "Niveles de dificultad"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  levels:
                    type: array
                    items:
                      type: string
                    example: ["easy", "medium", "hard"]

  /api/ai/generate-questions:
    post:
      tags: [AI]
      summary: Generar preguntas con IA (OpenAI)
      description: |
        Genera preguntas de trivia personalizadas usando OpenAI.
        Requiere autenticaci√≥n y proporciona preguntas en base al tema y dificultad solicitados.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                topic:
                  type: string
                  description: "Tema para las preguntas"
                  example: "ciencia"
                difficulty:
                  type: string
                  enum: ["easy", "medium", "hard"]
                  example: "medium"
                count:
                  type: integer
                  description: "Cantidad de preguntas a generar (1-10)"
                  example: 5
                useAI:
                  type: boolean
                  description: "Usar IA para generar preguntas"
                  example: true
      responses:
        '200':
          description: "Preguntas generadas exitosamente"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  topic:
                    type: string
                  difficulty:
                    type: string
                  count:
                    type: integer
                  questions:
                    type: array
                    items:
                      type: object
                      properties:
                        pregunta:
                          type: string
                          example: "¬øCu√°l es el elemento qu√≠mico m√°s abundante?"
                        opciones:
                          type: array
                          items:
                            type: string
                          example: ["Ox√≠geno", "Nitr√≥geno", "Carbono"]
                        respuestaCorrecta:
                          type: integer
                          example: 0
        '400':
          description: "Par√°metros inv√°lidos"
        '401':
          description: "No autenticado"
        '503':
          description: "Servicio de IA no disponible"

  /api/ai/generate-game-questions:
    post:
      tags: [AI]
      summary: Generar preguntas para un juego espec√≠fico
      description: |
        Genera preguntas de IA espec√≠ficamente para una partida.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                gameId:
                  type: string
                  description: "ID de la partida"
                topic:
                  type: string
                difficulty:
                  type: string
                count:
                  type: integer
      responses:
        '200':
          description: "Preguntas generadas para la partida"

  # ========================================
  # GAMES - MULTIPLAYER GAME MANAGEMENT
  # ========================================

  /api/games:
    get:
      tags: [Games]
      summary: Listar juegos p√∫blicos disponibles
      description: |
        Obtiene la lista de juegos p√∫blicos en estado "waiting" (esperando jugadores).
        **Rate limited**
      responses:
        '200':
          description: "Lista de juegos p√∫blicos disponibles"
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      example: "game123456"
                    gameTitle:
                      type: string
                      example: "Trivia de Ciencia"
                    topic:
                      type: string
                      example: "ciencia"
                    difficulty:
                      type: string
                      example: "medium"
                    createdBy:
                      type: string
                    status:
                      type: string
                      enum: ["waiting", "playing", "finished"]
                      example: "waiting"
                    maxPlayers:
                      type: integer
                      example: 4
                    currentPlayers:
                      type: integer
                      example: 1
                    createdAt:
                      type: string
                      format: date-time

  /api/games/{gameId}:
    delete:
      tags: [Games]
      summary: Eliminar juego p√∫blico
      description: |
        Elimina un juego p√∫blico. Solo el creador puede eliminar su juego.
        Requiere autenticaci√≥n.
      security:
        - bearerAuth: []
      parameters:
        - name: gameId
          in: path
          required: true
          schema:
            type: string
          description: "ID del juego a eliminar"
      responses:
        '200':
          description: "Juego eliminado exitosamente"
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Game deleted successfully"
        '403':
          description: "No autorizado para eliminar este juego"
        '404':
          description: "Juego no encontrado"

  # ========================================
  # QUESTIONS - QUESTION MANAGEMENT
  # ========================================

  /api/questions:
    get:
      tags: [Questions]
      summary: Obtener todas las preguntas
      description: |
        Retorna la lista completa de preguntas disponibles en la base de datos.
        **Rate limited** - Sin requiere autenticaci√≥n
      responses:
        '200':
          description: "Lista de todas las preguntas"
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      example: "q123456"
                    text:
                      type: string
                      example: "¬øCu√°l es la capital de Francia?"
                    options:
                      type: array
                      items:
                        type: string
                      example: ["Par√≠s", "Lyon", "Marsella"]
                    correctAnswerIndex:
                      type: integer
                      example: 0
                    category:
                      type: string
                      example: "geograf√≠a"
                    explanation:
                      type: string
                      example: "Par√≠s es la capital de Francia..."

    post:
      tags: [Questions]
      summary: Crear nueva pregunta
      description: |
        Crea una nueva pregunta en la base de datos.
        **Requiere autenticaci√≥n**
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                text:
                  type: string
                  example: "¬øCu√°l es el planeta m√°s grande?"
                options:
                  type: array
                  items:
                    type: string
                  example: ["J√∫piter", "Saturno", "Neptuno"]
                correctAnswerIndex:
                  type: integer
                  example: 0
                category:
                  type: string
                  example: "astronom√≠a"
                explanation:
                  type: string
      responses:
        '201':
          description: "Pregunta creada exitosamente"
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
        '400':
          description: "Par√°metros inv√°lidos"
        '401':
          description: "No autenticado"

  /api/questions/bulk:
    post:
      tags: [Questions]
      summary: Crear m√∫ltiples preguntas
      description: |
        Crea varias preguntas en una sola solicitud.
        **Requiere autenticaci√≥n**
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                questions:
                  type: array
                  items:
                    type: object
                  minItems: 1
      responses:
        '200':
          description: "Preguntas creadas exitosamente"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '400':
          description: "Sin preguntas proporcionadas"
        '401':
          description: "No autenticado"

  /api/questions/{id}:
    put:
      tags: [Questions]
      summary: Actualizar pregunta
      description: |
        Actualiza una pregunta existente.
        **Requiere autenticaci√≥n**
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: "ID de la pregunta"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: "Pregunta actualizada"
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Question updated"
        '400':
          description: "Error al actualizar"

    delete:
      tags: [Questions]
      summary: Eliminar pregunta
      description: |
        Elimina una pregunta.
        **Requiere autenticaci√≥n**
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: "ID de la pregunta"
      responses:
        '200':
          description: "Pregunta eliminada"
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Question deleted"
        '400':
          description: "Error al eliminar"

  # ===========================================
  # DOCUMENTACI√ìN DE EVENTOS WEBSOCKET
  # ===========================================

  # Eventos de entrada (cliente -> servidor):
  # - submitVoiceAnswer: Enviar respuesta de voz
  # - toggleVoiceMode: Activar/desactivar modo de voz
  # - getVoiceModeStatus: Obtener estado del modo de voz

  # Eventos de salida (servidor -> cliente):
  # - voiceAnswerReceived: Respuesta de voz recibida
  # - voiceAnswerError: Error en respuesta de voz
  # - voiceModeChanged: Modo de voz cambiado
  # - voiceModeStatus: Estado del modo de voz

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: "Token JWT de Firebase Auth"
  schemas:
    Question:
      type: object
      required: [text, options, correctAnswerIndex, category, difficulty, explanation]
      properties:
        text:
          type: string
          description: "Texto de la pregunta"
          example: "¬øCu√°l es el r√≠o m√°s largo del mundo?"
        options:
          type: array
          description: "Opciones de respuesta"
          items:
            type: string
          example: ["Nilo", "Amazonas", "Yangts√©", "Misisipi"]