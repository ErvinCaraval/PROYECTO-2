import{r as o,j as e}from"./index-BOaVjrce.js";import{C as y,b as w,a as C}from"./Card-Bn8pnOgw.js";import{B as p}from"./Button-D2tu_0bI.js";import{I as g}from"./Input-Cm1bFLR1.js";import{A as R}from"./Alert-BchDzBqE.js";import{L as T}from"./LoadingOverlay-rVvsqzvW.js";class U{constructor(){this.data={users:new Map,games:new Map,questions:new Map}}collection(c){return{doc:a=>({get:()=>Promise.resolve({exists:this.data[c].has(a),data:()=>this.data[c].get(a)}),set:n=>(this.data[c].set(a,n),Promise.resolve()),update:n=>{const d=this.data[c].get(a)||{};return this.data[c].set(a,{...d,...n}),Promise.resolve()},delete:()=>(this.data[c].delete(a),Promise.resolve())}),add:a=>{const n="doc-"+Date.now()+"-"+Math.random().toString(36).substr(2,9);return this.data[c].set(n,a),Promise.resolve({id:n})},get:()=>Promise.resolve({docs:Array.from(this.data[c].entries()).map(([a,n])=>({id:a,data:()=>n}))})}}}const u=new U,S={text:"",options:["","","",""],correctAnswerIndex:0,category:"",explanation:""};function _(){var M,V,I,P;const[A,c]=o.useState([]),[a,n]=o.useState(S),[d,j]=o.useState(null),[D,E]=o.useState(!0),[h,z]=o.useState({}),[l,k]=o.useState({}),[F,x]=o.useState(!1),[b,f]=o.useState(""),v=async()=>{E(!0);const s=await u.collection("questions").get();c(s.docs.map(t=>({id:t.id,...t.data()}))),E(!1)};o.useEffect(()=>{v(),B()},[]);const B=async()=>{x(!0);try{const s="http://localhost:5000",t=await fetch(`${s}/api/admin/accessibility-stats`);if(t.ok){const r=await t.json();z(r)}const i=await fetch(`${s}/api/admin/accessibility-settings`);if(i.ok){const r=await i.json();k(r)}}catch(s){console.error("Error fetching accessibility data:",s),f("Error cargando datos de accesibilidad")}finally{x(!1)}},m=async s=>{x(!0);try{const i=await fetch("http://localhost:5000/api/admin/accessibility-settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(i.ok){const r=await i.json();k(r),f("Configuración de accesibilidad actualizada correctamente")}else throw new Error("Error updating settings")}catch(t){console.error("Error updating accessibility settings:",t),f("Error actualizando configuración de accesibilidad")}finally{x(!1)}},N=s=>{const{name:t,value:i}=s.target;n(r=>({...r,[t]:i}))},L=(s,t)=>{n(i=>{const r=[...i.options];return r[s]=t,{...i,options:r}})},O=async s=>{s.preventDefault(),d?await u.collection("questions").doc(d).update(a):await u.collection("questions").add(a),n(S),j(null),v()},Q=s=>{n(s),j(s.id)},$=async s=>{await u.collection("questions").doc(s).delete(),v()};return e.jsxs("div",{className:"container min-h-screen px-4 py-8 space-y-6",children:[F&&e.jsx(T,{}),e.jsxs(y,{children:[e.jsx(w,{children:e.jsx("h2",{className:"text-2xl font-bold",children:"Panel de Accesibilidad"})}),e.jsxs(C,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Estadísticas de Accesibilidad"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-500/10 rounded-lg border border-blue-500/20",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:h.totalUsersWithVoiceMode||0}),e.jsx("div",{className:"text-sm text-white/70",children:"Usuarios con modo de voz"})]}),e.jsxs("div",{className:"p-4 bg-green-500/10 rounded-lg border border-green-500/20",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:h.totalVoiceInteractions||0}),e.jsx("div",{className:"text-sm text-white/70",children:"Interacciones de voz"})]}),e.jsxs("div",{className:"p-4 bg-purple-500/10 rounded-lg border border-purple-500/20",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:[h.voiceModeAdoptionRate||0,"%"]}),e.jsx("div",{className:"text-sm text-white/70",children:"Tasa de adopción"})]}),e.jsxs("div",{className:"p-4 bg-orange-500/10 rounded-lg border border-orange-500/20",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-400",children:[h.averageVoiceSessionDuration||0,"s"]}),e.jsx("div",{className:"text-sm text-white/70",children:"Duración promedio"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Configuración Global de Accesibilidad"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"voiceModeEnabled",checked:l.voiceModeEnabled||!1,onChange:s=>m({voiceModeEnabled:s.target.checked}),className:"h-4 w-4 text-blue-600 bg-white/10 border-white/20 rounded focus:ring-blue-500 focus:ring-2"}),e.jsx("label",{htmlFor:"voiceModeEnabled",className:"text-sm text-white/80",children:"Habilitar modo de voz globalmente"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-white/80",children:"Velocidad de voz por defecto"}),e.jsx("input",{type:"range",min:"0.5",max:"2",step:"0.1",value:((M=l.defaultVoiceSettings)==null?void 0:M.rate)||1,onChange:s=>m({defaultVoiceSettings:{...l.defaultVoiceSettings,rate:parseFloat(s.target.value)}}),className:"w-full h-2 bg-white/20 rounded-lg appearance-none cursor-pointer slider"}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[((V=l.defaultVoiceSettings)==null?void 0:V.rate)||1,"x"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-white/80",children:"Volumen por defecto"}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:((I=l.defaultVoiceSettings)==null?void 0:I.volume)||1,onChange:s=>m({defaultVoiceSettings:{...l.defaultVoiceSettings,volume:parseFloat(s.target.value)}}),className:"w-full h-2 bg-white/20 rounded-lg appearance-none cursor-pointer slider"}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[Math.round((((P=l.defaultVoiceSettings)==null?void 0:P.volume)||1)*100),"%"]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Funcionalidades de Accesibilidad"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.features&&Object.entries(l.features).map(([s,t])=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:s,checked:t,onChange:i=>m({features:{...l.features,[s]:i.target.checked}}),className:"h-4 w-4 text-blue-600 bg-white/10 border-white/20 rounded focus:ring-blue-500 focus:ring-2"}),e.jsx("label",{htmlFor:s,className:"text-sm text-white/80 capitalize",children:s.replace(/([A-Z])/g," $1").toLowerCase()})]},s))})]})]})]}),e.jsxs(y,{children:[e.jsx(w,{className:"pb-2",children:e.jsx("h2",{className:"text-2xl font-bold",children:"Admin Panel"})}),e.jsx(C,{children:e.jsxs("form",{onSubmit:O,className:"grid gap-3",children:[e.jsx(g,{name:"text",value:a.text,onChange:N,placeholder:"Question text",required:!0}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[e.jsx(g,{name:"category",value:a.category,onChange:N,placeholder:"Category",required:!0}),e.jsx(g,{name:"explanation",value:a.explanation,onChange:N,placeholder:"Explanation",required:!0}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("span",{className:"text-sm text-white/70",children:"Correcta"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:a.options.map((s,t)=>e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"radio",name:"correctAnswerIndex",checked:a.correctAnswerIndex===t,onChange:()=>n(i=>({...i,correctAnswerIndex:t})),className:"h-4 w-4"}),e.jsx("span",{children:t+1})]},t))})]})]}),e.jsx("div",{className:"grid gap-3 sm:grid-cols-2",children:a.options.map((s,t)=>e.jsx(g,{value:s,onChange:i=>L(t,i.target.value),placeholder:`Option ${t+1}`,required:!0},t))}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[d&&e.jsx(p,{type:"button",variant:"secondary",onClick:()=>{n(S),j(null)},children:"Cancel"}),e.jsxs(p,{type:"submit",children:[d?"Update":"Add"," Question"]})]})]})})]}),e.jsxs(y,{children:[e.jsx(w,{className:"pb-2",children:e.jsx("h3",{className:"text-xl font-semibold",children:"Questions"})}),e.jsx(C,{children:D?e.jsxs("div",{className:"flex items-center gap-3 text-white/80",children:[e.jsx("div",{className:"loading-spinner"})," Loading…"]}):e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"text-left",children:e.jsxs("tr",{className:"border-b border-white/10",children:[e.jsx("th",{className:"py-2 pr-3",children:"Text"}),e.jsx("th",{className:"py-2 pr-3",children:"Category"}),e.jsx("th",{className:"py-2 pr-3",children:"Options"}),e.jsx("th",{className:"py-2 pr-3",children:"Correct"}),e.jsx("th",{className:"py-2 pr-3",children:"Explanation"}),e.jsx("th",{className:"py-2",children:"Actions"})]})}),e.jsx("tbody",{children:A.map(s=>e.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5",children:[e.jsx("td",{className:"py-2 pr-3 align-top",children:s.text}),e.jsx("td",{className:"py-2 pr-3 align-top",children:s.category}),e.jsx("td",{className:"py-2 pr-3 align-top",children:s.options.join(", ")}),e.jsx("td",{className:"py-2 pr-3 align-top",children:s.options[s.correctAnswerIndex]}),e.jsx("td",{className:"py-2 pr-3 align-top",children:s.explanation}),e.jsxs("td",{className:"py-2 flex gap-2",children:[e.jsx(p,{variant:"secondary",onClick:()=>Q(s),children:"Edit"}),e.jsx(p,{variant:"outline",onClick:()=>$(s.id),children:"Delete"})]})]},s.id))})]})})})]}),b&&e.jsx(R,{intent:b.includes("Error")?"error":"success",children:b})]})}export{_ as default};
//# sourceMappingURL=AdminPage-XdXbes6x.js.map
