{"version":3,"mappings":"wCAAA,IAAIA,EAAS,KAEb,MAAMC,EAAe,IAEf,OAAO,OAAW,KAAe,OAAO,KAAK,gBACxC,OAAO,IAAI,gBAGhB,OAAO,OAAW,KAAe,OAAO,KAAK,aACxC,OAAO,IAAI,aAIX,yCASX,eAAsBC,GAAY,CAChC,GAAIF,EAAQ,OAAOA,EACnB,KAAM,CAAE,GAAAG,CAAA,EAAO,MAAAC,EAAA,mBAAAD,CAAA,OAAM,QAAO,qBAAkB,YAAAA,CAAA,OAGxCE,EAAW,iEAAiE,KAAK,UAAU,SAAS,EAE1G,OAAAL,EAASG,EAAGF,IAAgB,CAC1B,YAAa,GAEb,WAAYI,EAAW,CAAC,UAAW,WAAW,EAAI,CAAC,YAAa,SAAS,EACzE,QAASA,EAAW,KAAU,OAAO,OAAW,KAAe,OAAO,KAAK,qBAAwB,QAAuC,IAC1I,SAAU,GACV,aAAc,GACd,qBAAsBA,EAAW,EAAI,EACrC,kBAAmBA,EAAW,IAAO,IACrC,qBAAsBA,EAAW,KAAQ,IACzC,wBAAyBA,EAAW,EAAI,EAExC,QAAS,GACT,gBAAiB,GAEjB,YAAaA,EAAW,IAAQ,IAChC,aAAcA,EAAW,KAAQ,IAClC,EAEML,CACT,CAEO,SAASM,GAAmB,CACjC,GAAIN,EAAQ,CACV,GAAI,CAAEA,EAAO,YAAc,MAAY,CAAa,CACpDA,EAAS,IACX,CACF","names":["socket","getSocketUrl","getSocket","io","__vitePreload","isMobile","disconnectSocket"],"ignoreList":[],"sources":["../../src/services/socket.js"],"sourcesContent":["let socket = null;\n\nconst getSocketUrl = () => {\n  // Primero intenta window.ENV (runtime)\n  if (typeof window !== 'undefined' && window.ENV?.VITE_SOCKET_URL) {\n    return window.ENV.VITE_SOCKET_URL;\n  }\n  // Fallback a window.ENV.VITE_API_URL\n  if (typeof window !== 'undefined' && window.ENV?.VITE_API_URL) {\n    return window.ENV.VITE_API_URL;\n  }\n  // Fallback a import.meta.env (build-time)\n  if (import.meta.env.VITE_SOCKET_URL) {\n    return import.meta.env.VITE_SOCKET_URL;\n  }\n  if (import.meta.env.VITE_API_URL) {\n    return import.meta.env.VITE_API_URL;\n  }\n  // Default\n  return 'http://localhost:5000';\n};\n\nexport async function getSocket() {\n  if (socket) return socket;\n  const { io } = await import('socket.io-client');\n  \n  // Configuración optimizada para dispositivos móviles\n  const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n  \n  socket = io(getSocketUrl(), { \n    autoConnect: false,\n    // Configuración optimizada para dispositivos móviles\n    transports: isMobile ? ['polling', 'websocket'] : ['websocket', 'polling'],\n    timeout: isMobile ? 15000 : ((typeof window !== 'undefined' && window.ENV?.VITE_SOCKET_TIMEOUT) || import.meta.env.VITE_SOCKET_TIMEOUT || 8000),\n    forceNew: true, // Forzar nueva conexión\n    reconnection: true,\n    reconnectionAttempts: isMobile ? 8 : 5,\n    reconnectionDelay: isMobile ? 3000 : 1000,\n    reconnectionDelayMax: isMobile ? 15000 : 8000,\n    maxReconnectionAttempts: isMobile ? 8 : 5,\n    // Configuraciones adicionales para móviles\n    upgrade: true,\n    rememberUpgrade: false,\n    // Mejorar estabilidad en redes móviles\n    pingTimeout: isMobile ? 60000 : 20000,\n    pingInterval: isMobile ? 25000 : 10000\n  });\n  \n  return socket;\n}\n\nexport function disconnectSocket() {\n  if (socket) {\n    try { socket.disconnect(); } catch (e) { /* noop */ }\n    socket = null;\n  }\n}\n"],"file":"socket-M0HrJEIC.js"}