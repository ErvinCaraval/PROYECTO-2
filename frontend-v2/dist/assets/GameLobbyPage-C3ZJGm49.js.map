{"version":3,"file":"GameLobbyPage-C3ZJGm49.js","sources":["../../src/pages/GameLobbyPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { AnimatePresence, motion } from \"framer-motion\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"../AuthContext\";\nimport { useVoice } from \"../VoiceContext\";\nimport { getSocket, disconnectSocket } from \"../services/socket\";\nimport Button from \"../components/ui/Button\";\nimport Alert from \"../components/ui/Alert\";\nimport { Card, CardBody, CardHeader } from \"../components/ui/Card\";\nimport LoadingOverlay from \"../components/ui/LoadingOverlay\";\nimport Skeleton from \"../components/ui/Skeleton\";\n\nexport default function GameLobbyPage() {\n  const { gameId } = useParams();\n  const { user } = useAuth();\n  const { isVoiceModeEnabled, speak } = useVoice();\n  const [players, setPlayers] = useState([]);\n  const [hostId, setHostId] = useState(null);\n  const [status] = useState(\"waiting\");\n  const [error, setError] = useState(\"\");\n  const navigate = useNavigate();\n  const [connected, setConnected] = useState(false);\n  const [connectionTimeout, setConnectionTimeout] = useState(false);\n  const [timeRemaining, setTimeRemaining] = useState(0);\n\n  // Voice announce helper\n  const announce = (text) => {\n    if (isVoiceModeEnabled) {\n      speak(text, {\n        action: \"text_read\",\n        questionId: \"lobby\",\n        metadata: { origin: \"lobby\" },\n      });\n    }\n  };\n\n  useEffect(() => {\n    if (!user) return;\n\n    (async () => {\n      if (!user) return;\n      const socket = await getSocket();\n\n      // Timeout adaptativo para evitar que se quede colgado en \"Conectando a la sala...\"\n      const isMobile =\n        /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n          navigator.userAgent\n        );\n      const timeoutDuration = isMobile ? 10000 : 15000; // 10s para m√≥viles, 15s para desktop\n\n      let connectionTimeoutId;\n      let countdownInterval;\n\n      // Forzar reconexi√≥n si no est√° conectado\n      if (!socket.connected) {\n        console.log(\"[GameLobbyPage] Socket no conectado, reconectando...\");\n        socket.disconnect();\n        socket.connect();\n\n        // Solo iniciar timeout si no est√° conectado\n        setTimeRemaining(timeoutDuration / 1000); // Convertir a segundos\n\n        connectionTimeoutId = setTimeout(() => {\n          if (!socket.connected) {\n            setConnectionTimeout(true);\n            setTimeRemaining(0);\n            console.warn(\n              \"[GameLobbyPage] Timeout de conexi√≥n alcanzado despu√©s de\",\n              timeoutDuration,\n              \"ms\"\n            );\n          }\n        }, timeoutDuration);\n\n        // Contador visual\n        countdownInterval = setInterval(() => {\n          setTimeRemaining((prev) => {\n            if (prev <= 1) {\n              clearInterval(countdownInterval);\n              return 0;\n            }\n            return prev - 1;\n          });\n        }, 1000);\n      } else {\n        console.log(\"[GameLobbyPage] Socket ya conectado:\", socket.id);\n        setConnected(true);\n        setConnectionTimeout(false);\n      }\n\n      // UI optimista\n      setPlayers((prev) =>\n        prev.length === 0\n          ? [\n              {\n                uid: user.uid,\n                displayName: user.displayName || user.email,\n                email: user.email,\n              },\n            ]\n          : prev\n      );\n      setHostId((prev) => prev ?? user.uid);\n\n      function onConnect() {\n        setConnected(true);\n        setConnectionTimeout(false);\n        setTimeRemaining(0);\n        if (connectionTimeoutId) {\n          clearTimeout(connectionTimeoutId);\n        }\n        if (countdownInterval) {\n          clearInterval(countdownInterval);\n        }\n      }\n      function onDisconnect() {\n        setConnected(false);\n      }\n      function onConnectError(error) {\n        console.error(\"[GameLobbyPage] Error de conexi√≥n:\", error);\n        setConnectionTimeout(true);\n        setTimeRemaining(0);\n        if (connectionTimeoutId) {\n          clearTimeout(connectionTimeoutId);\n        }\n        if (countdownInterval) {\n          clearInterval(countdownInterval);\n        }\n      }\n\n      socket.on(\"connect\", onConnect);\n      socket.on(\"disconnect\", onDisconnect);\n      socket.on(\"connect_error\", onConnectError);\n\n      socket.emit(\"joinGame\", {\n        gameId,\n        uid: user.uid,\n        displayName: user.displayName || user.email,\n      });\n\n      socket.on(\"playerJoined\", ({ players }) => {\n        setPlayers(players);\n        if (players.length > 0) setHostId(players[0].uid);\n      });\n\n      socket.on(\"gameStarted\", () => {\n        console.log(\n          \"[GameLobbyPage] Evento gameStarted recibido, navegando a /game/\" +\n            gameId\n        );\n        navigate(`/game/${gameId}`);\n      });\n\n      socket.on(\"error\", ({ error }) => {\n        setError(error);\n      });\n\n      // cleanup\n      return () => {\n        if (connectionTimeoutId) {\n          clearTimeout(connectionTimeoutId);\n        }\n        if (countdownInterval) {\n          clearInterval(countdownInterval);\n        }\n        socket.off(\"playerJoined\");\n        socket.off(\"gameStarted\");\n        socket.off(\"error\");\n        socket.off(\"connect\", onConnect);\n        socket.off(\"disconnect\", onDisconnect);\n        socket.off(\"connect_error\", onConnectError);\n        disconnectSocket();\n      };\n    })();\n  }, [gameId, user, navigate]);\n\n  const handleStart = () => {\n    console.log(\"[GameLobbyPage] Emitiendo startGame:\", { gameId });\n    (async () => {\n      const socket = await getSocket();\n      socket.emit(\"startGame\", { gameId });\n    })();\n  };\n\n  const copyGameCode = () => {\n    navigator.clipboard.writeText(gameId);\n    alert(\"Game code copied to clipboard!\");\n  };\n\n  const retryConnection = async () => {\n    setConnectionTimeout(false);\n    setConnected(false);\n\n    try {\n      const socket = await getSocket();\n      console.log(\"[GameLobbyPage] Reintentando conexi√≥n...\");\n\n      // Desconectar completamente y reconectar\n      socket.disconnect();\n      socket.removeAllListeners();\n\n      // Esperar un momento antes de reconectar\n      setTimeout(() => {\n        socket.connect();\n      }, 1000);\n    } catch (error) {\n      console.error(\"[GameLobbyPage] Error al reintentar conexi√≥n:\", error);\n      setConnectionTimeout(true);\n    }\n  };\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen container px-4 py-10\">\n        <Alert intent=\"error\" className=\"mb-4\">\n          {error === \"Game already started\"\n            ? \"La partida ya ha comenzado. No puedes unirte en este momento.\"\n            : error}\n        </Alert>\n        <Button\n          onClick={() => navigate(\"/dashboard\")}\n          onFocus={() => announce(\"Volver al panel principal\")}\n          onMouseEnter={() => announce(\"Volver al panel principal\")}\n        >\n          Volver al inicio\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen container px-4 py-8\">\n      {!connected && !connectionTimeout && (\n        <span className=\"sr-only\" aria-live=\"polite\">\n          {`Conectando a la sala ${\n            timeRemaining > 0 ? `(${timeRemaining}s)` : \"\"\n          }`}\n        </span>\n      )}\n      {!connected && !connectionTimeout && (\n        <LoadingOverlay\n          text={`Conectando a la sala‚Ä¶ ${\n            timeRemaining > 0 ? `(${timeRemaining}s)` : \"\"\n          }`}\n          mobileOnly\n        />\n      )}\n      {connectionTimeout && (\n        <div\n          className=\"fixed inset-0 z-[3500] flex items-center justify-center px-6 md:hidden\"\n          role=\"dialog\"\n          aria-modal=\"true\"\n          aria-labelledby=\"lobby-conn-title\"\n          aria-describedby=\"lobby-conn-desc\"\n        >\n          <div className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\" />\n          <div className=\"relative flex flex-col items-center gap-4 rounded-2xl border border-white/10 bg-bb-bg-primary/90 px-6 py-4 shadow-xl\">\n            <div className=\"text-center\">\n              <div id=\"lobby-conn-title\" className=\"text-lg font-semibold mb-2\">\n                ‚ö†Ô∏è Problema de conexi√≥n\n              </div>\n              <p id=\"lobby-conn-desc\" className=\"text-sm text-white/80 mb-4\">\n                No se pudo conectar a la sala. Esto puede deberse a problemas de\n                red o el servidor.\n              </p>\n              <div className=\"flex gap-2\">\n                <Button\n                  variant=\"secondary\"\n                  size=\"sm\"\n                  onClick={retryConnection}\n                  title=\"Reintentar conexi√≥n\"\n                >\n                  üîÑ Reintentar\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => navigate(\"/dashboard\")}\n                  title=\"Volver al inicio\"\n                >\n                  üè† Volver\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n      <header className=\"flex flex-col md:flex-row md:items-end md:justify-between gap-4 mb-6\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">üéÆ Sala de Juego</h1>\n          <p className=\"text-white/70\">\n            Comparte el c√≥digo para que tus amigos se unan\n          </p>\n          {isVoiceModeEnabled && (\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"mt-2\"\n              onClick={async () => {\n                const parts = [];\n                parts.push(\"Est√°s en la sala de juego.\");\n                parts.push(\n                  \"Arriba est√° el c√≥digo de la partida que puedes copiar para compartir.\"\n                );\n                parts.push(\n                  \"A la izquierda ver√°s la lista de jugadores conectados.\"\n                );\n                parts.push(\n                  \"A la derecha est√°n las acciones: iniciar partida si eres anfitri√≥n, o esperar si eres jugador.\"\n                );\n                parts.push(\n                  \"El anfitri√≥n puede iniciar cuando haya al menos un jugador.\"\n                );\n                speak(parts.join(\" \"), {\n                  action: \"page_guide\",\n                  questionId: \"lobby\",\n                  force: true,\n                });\n              }}\n              aria-label=\"Explicar la p√°gina\"\n              title=\"Explicar la p√°gina\"\n            >\n              üõà Explicar p√°gina\n            </Button>\n          )}\n        </div>\n        <Card className=\"w-full md:w-auto\">\n          <CardBody className=\"flex items-center gap-3\">\n            <div>\n              <div className=\"text-sm text-white/70\">C√≥digo</div>\n              <div className=\"text-xl font-bold tracking-widest\">{gameId}</div>\n            </div>\n            <Button\n              variant=\"secondary\"\n              onClick={copyGameCode}\n              aria-label=\"Copiar c√≥digo\"\n              onFocus={() => announce(\"Copiar c√≥digo de la partida\")}\n              onMouseEnter={() => announce(\"Copiar c√≥digo de la partida\")}\n              className=\"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-bb-primary\"\n              title=\"Copiar c√≥digo\"\n            >\n              üìã Copiar\n            </Button>\n          </CardBody>\n        </Card>\n      </header>\n\n      <main className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <Card className=\"lg:col-span-2\">\n          <CardHeader className=\"pb-2\">\n            <h3 className=\"text-2xl font-semibold\">\n              üë• Jugadores ({players.length})\n            </h3>\n          </CardHeader>\n          <CardBody>\n            <div\n              className=\"grid gap-3 sm:grid-cols-2\"\n              role=\"list\"\n              aria-label=\"Lista de jugadores\"\n            >\n              <AnimatePresence>\n                {(players && players.length > 0\n                  ? players\n                  : connected\n                  ? []\n                  : Array.from({ length: 4 }).map((_, i) => ({\n                      uid: `sk-${i}`,\n                      _sk: true,\n                    }))\n                ).map((player) => (\n                  <motion.div\n                    key={player.uid}\n                    layout\n                    initial={{ opacity: 0, y: 8 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    exit={{ opacity: 0, y: -8 }}\n                    transition={{ type: \"spring\", stiffness: 140, damping: 16 }}\n                    className={`flex items-center gap-3 rounded-xl border border-white/10 bg-white/5 px-4 py-3 transition-transform duration-150 hover:-translate-y-0.5 ${\n                      player.uid === hostId ? \"ring-1 ring-bb-primary/50\" : \"\"\n                    }`}\n                    role=\"listitem\"\n                    aria-label={\n                      player._sk\n                        ? \"Cargando jugador\"\n                        : `${player.displayName || player.email}${\n                            player.uid === hostId ? \" (Anfitri√≥n)\" : \"\"\n                          }`\n                    }\n                  >\n                    {player._sk ? (\n                      <>\n                        <Skeleton className=\"h-8 w-8 rounded-full\" />\n                        <div className=\"flex-1 min-w-0\">\n                          <Skeleton className=\"h-4 w-40\" />\n                        </div>\n                      </>\n                    ) : (\n                      <>\n                        <div className=\"text-xl\">\n                          {player.uid === hostId ? \"üëë\" : \"üë§\"}\n                        </div>\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"font-semibold truncate\">\n                            {player.displayName || player.email}\n                          </div>\n                          {player.uid === hostId && (\n                            <div className=\"text-xs text-white/70\">\n                              Anfitri√≥n\n                            </div>\n                          )}\n                        </div>\n                      </>\n                    )}\n                  </motion.div>\n                ))}\n              </AnimatePresence>\n            </div>\n          </CardBody>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <h3 className=\"text-2xl font-semibold\">Acciones</h3>\n          </CardHeader>\n          <CardBody className=\"space-y-3\">\n            {user && user.uid === hostId && status === \"waiting\" ? (\n              <>\n                <p>¬øListo para comenzar la partida?</p>\n                <Button\n                  onClick={handleStart}\n                  disabled={players.length < 1}\n                  size=\"lg\"\n                  onFocus={() => announce(\"Iniciar la partida\")}\n                  onMouseEnter={() => announce(\"Iniciar la partida\")}\n                  aria-disabled={players.length < 1}\n                  title={\n                    players.length < 1\n                      ? \"Esperando jugadores\"\n                      : \"Iniciar partida\"\n                  }\n                  aria-describedby={\n                    players.length < 1 ? \"players-waiting-hint\" : undefined\n                  }\n                >\n                  üöÄ Iniciar partida\n                </Button>\n                {players.length < 1 && (\n                  <p\n                    id=\"players-waiting-hint\"\n                    className=\"text-sm text-white/70\"\n                  >\n                    Esperando a que se unan jugadores...\n                  </p>\n                )}\n              </>\n            ) : (\n              <div className=\"flex items-center gap-3\" aria-live=\"polite\">\n                <span>‚è≥</span>\n                <p className=\"text-sm text-white/80\">\n                  Esperando a que el anfitri√≥n inicie la partida‚Ä¶\n                </p>\n              </div>\n            )}\n          </CardBody>\n        </Card>\n      </main>\n    </div>\n  );\n}\n"],"names":["GameLobbyPage","gameId","useParams","user","useAuth","isVoiceModeEnabled","speak","useVoice","players","setPlayers","useState","hostId","setHostId","status","error","setError","navigate","useNavigate","connected","setConnected","connectionTimeout","setConnectionTimeout","timeRemaining","setTimeRemaining","announce","text","useEffect","socket","getSocket","timeoutDuration","connectionTimeoutId","countdownInterval","prev","onConnect","onDisconnect","onConnectError","disconnectSocket","handleStart","copyGameCode","retryConnection","jsxs","jsx","Alert","Button","LoadingOverlay","parts","Card","CardBody","CardHeader","AnimatePresence","_","i","player","motion","Fragment","Skeleton"],"mappings":"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"}