import{r as d,j as e}from"./index-BaYh_0Lp.js";import{C as v,b as N,a as A}from"./Card-CVO-GHPj.js";import{B as b}from"./Button-CeP88Yp2.js";import{I as y}from"./Input-B3ZbH6y3.js";import{A as P}from"./Alert-CT4I4Ncm.js";import{L as z}from"./LoadingOverlay-3aZpPDtu.js";class M{constructor(){this.baseUrl="http://localhost:5000/api"}async getAuthHeaders(){const a=localStorage.getItem("authToken");return{"Content-Type":"application/json",...a&&{Authorization:`Bearer ${a}`}}}async getAllQuestions(){try{const a=await this.getAuthHeaders(),s=await fetch(`${this.baseUrl}/api/questions`,{headers:a});if(!s.ok)throw new Error(`Failed to fetch questions: ${s.status}`);return await s.json()}catch(a){throw console.error("Error fetching questions:",a),a}}async createQuestion(a){try{const s=await this.getAuthHeaders(),r=await fetch(`${this.baseUrl}/api/questions`,{method:"POST",headers:s,body:JSON.stringify(a)});if(!r.ok)throw new Error(`Failed to create question: ${r.status}`);return await r.json()}catch(s){throw console.error("Error creating question:",s),s}}async updateQuestion(a,s){try{const r=await this.getAuthHeaders(),n=await fetch(`${this.baseUrl}/api/questions/${a}`,{method:"PUT",headers:r,body:JSON.stringify(s)});if(!n.ok)throw new Error(`Failed to update question: ${n.status}`);return await n.json()}catch(r){throw console.error("Error updating question:",r),r}}async deleteQuestion(a){try{const s=await this.getAuthHeaders(),r=await fetch(`${this.baseUrl}/api/questions/${a}`,{method:"DELETE",headers:s});if(!r.ok)throw new Error(`Failed to delete question: ${r.status}`);return await r.json()}catch(s){throw console.error("Error deleting question:",s),s}}async getAccessibilityStats(){try{const a=await this.getAuthHeaders(),s=await fetch(`${this.baseUrl}/api/admin/accessibility-stats`,{headers:a});if(!s.ok)throw new Error(`Failed to fetch accessibility stats: ${s.status}`);return await s.json()}catch(a){return console.error("Error fetching accessibility stats:",a),{}}}async getAccessibilitySettings(){try{const a=await this.getAuthHeaders(),s=await fetch(`${this.baseUrl}/api/admin/accessibility-settings`,{headers:a});if(!s.ok)throw new Error(`Failed to fetch accessibility settings: ${s.status}`);return await s.json()}catch(a){return console.error("Error fetching accessibility settings:",a),{}}}async updateAccessibilitySettings(a){try{const s=await this.getAuthHeaders(),r=await fetch(`${this.baseUrl}/api/admin/accessibility-settings`,{method:"PUT",headers:s,body:JSON.stringify(a)});if(!r.ok)throw new Error(`Failed to update accessibility settings: ${r.status}`);return await r.json()}catch(s){throw console.error("Error updating accessibility settings:",s),s}}async getUsersWithVoiceMode(){try{const a=await this.getAuthHeaders(),s=await fetch(`${this.baseUrl}/api/admin/voice-mode-users`,{headers:a});if(!s.ok)throw new Error(`Failed to fetch voice mode users: ${s.status}`);return await s.json()}catch(a){return console.error("Error fetching voice mode users:",a),[]}}async getAccessibilityReport(a,s){try{const r=await this.getAuthHeaders(),n=new URLSearchParams;a&&n.append("startDate",a),s&&n.append("endDate",s);const h=await fetch(`${this.baseUrl}/api/admin/accessibility-report?${n}`,{headers:r});if(!h.ok)throw new Error(`Failed to fetch accessibility report: ${h.status}`);return await h.json()}catch(r){return console.error("Error fetching accessibility report:",r),{}}}}const u=new M,E={text:"",options:["","","",""],correctAnswerIndex:0,category:"",explanation:""};function J(){const[S,a]=d.useState([]),[s,r]=d.useState(E),[n,h]=d.useState(null),[k,C]=d.useState(!0),[g,U]=d.useState({}),[o,$]=d.useState({}),[F,p]=d.useState(!1),[j,l]=d.useState(""),f=async()=>{C(!0);try{const t=await u.getAllQuestions();a(Array.isArray(t)?t:[])}catch(t){console.error("Error fetching questions:",t),l("Error cargando preguntas")}finally{C(!1)}};d.useEffect(()=>{f(),V()},[]);const V=async()=>{p(!0);try{const t=await u.getAccessibilityStats(),i=await u.getAccessibilitySettings();U(t),$(i)}catch(t){console.error("Error fetching accessibility data:",t),l("Error cargando datos de accesibilidad")}finally{p(!1)}},m=async t=>{p(!0);try{const i=await u.updateAccessibilitySettings(t);$(i),l("Configuración de accesibilidad actualizada correctamente")}catch(i){console.error("Error updating accessibility settings:",i),l("Error actualizando configuración de accesibilidad")}finally{p(!1)}},w=t=>{const{name:i,value:c}=t.target;r(x=>({...x,[i]:c}))},Q=(t,i)=>{r(c=>{const x=[...c.options];return x[t]=i,{...c,options:x}})},H=async t=>{t.preventDefault();try{n?(await u.updateQuestion(n,s),l("Pregunta actualizada correctamente")):(await u.createQuestion(s),l("Pregunta creada correctamente")),r(E),h(null),f()}catch(i){console.error("Error saving question:",i),l("Error guardando pregunta")}},I=t=>{r(t),h(t.id)},q=async t=>{try{await u.deleteQuestion(t),l("Pregunta eliminada correctamente"),f()}catch(i){console.error("Error deleting question:",i),l("Error eliminando pregunta")}};return e.jsxs("div",{className:"container min-h-screen px-4 py-8 space-y-6",children:[F&&e.jsx(z,{}),e.jsxs(v,{children:[e.jsx(N,{children:e.jsx("h2",{className:"text-2xl font-bold",children:"Panel de Accesibilidad"})}),e.jsxs(A,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Estadísticas de Accesibilidad"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-500/10 rounded-lg border border-blue-500/20",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:g.totalUsersWithVoiceMode||0}),e.jsx("div",{className:"text-sm text-white/70",children:"Usuarios con modo de voz"})]}),e.jsxs("div",{className:"p-4 bg-green-500/10 rounded-lg border border-green-500/20",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:g.totalVoiceInteractions||0}),e.jsx("div",{className:"text-sm text-white/70",children:"Interacciones de voz"})]}),e.jsxs("div",{className:"p-4 bg-purple-500/10 rounded-lg border border-purple-500/20",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:[g.voiceModeAdoptionRate||0,"%"]}),e.jsx("div",{className:"text-sm text-white/70",children:"Tasa de adopción"})]}),e.jsxs("div",{className:"p-4 bg-orange-500/10 rounded-lg border border-orange-500/20",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-400",children:[g.averageVoiceSessionDuration||0,"s"]}),e.jsx("div",{className:"text-sm text-white/70",children:"Duración promedio"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Configuración Global de Accesibilidad"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"voiceModeEnabled",checked:o.voiceModeEnabled||!1,onChange:t=>m({voiceModeEnabled:t.target.checked}),className:"h-4 w-4 text-blue-600 bg-white/10 border-white/20 rounded focus:ring-blue-500 focus:ring-2"}),e.jsx("label",{htmlFor:"voiceModeEnabled",className:"text-sm text-white/80",children:"Habilitar modo de voz globalmente"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-white/80",children:"Velocidad de voz por defecto"}),e.jsx("input",{type:"range",min:"0.5",max:"2",step:"0.1",value:o.defaultVoiceSettings?.rate||1,onChange:t=>m({defaultVoiceSettings:{...o.defaultVoiceSettings,rate:parseFloat(t.target.value)}}),className:"w-full h-2 bg-white/20 rounded-lg appearance-none cursor-pointer slider"}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[o.defaultVoiceSettings?.rate||1,"x"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-white/80",children:"Volumen por defecto"}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:o.defaultVoiceSettings?.volume||1,onChange:t=>m({defaultVoiceSettings:{...o.defaultVoiceSettings,volume:parseFloat(t.target.value)}}),className:"w-full h-2 bg-white/20 rounded-lg appearance-none cursor-pointer slider"}),e.jsxs("div",{className:"text-xs text-white/60 mt-1",children:[Math.round((o.defaultVoiceSettings?.volume||1)*100),"%"]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Funcionalidades de Accesibilidad"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.features&&Object.entries(o.features).map(([t,i])=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:t,checked:i,onChange:c=>m({features:{...o.features,[t]:c.target.checked}}),className:"h-4 w-4 text-blue-600 bg-white/10 border-white/20 rounded focus:ring-blue-500 focus:ring-2"}),e.jsx("label",{htmlFor:t,className:"text-sm text-white/80 capitalize",children:t.replace(/([A-Z])/g," $1").toLowerCase()})]},t))})]})]})]}),e.jsxs(v,{children:[e.jsx(N,{className:"pb-2",children:e.jsx("h2",{className:"text-2xl font-bold",children:"Admin Panel"})}),e.jsx(A,{children:e.jsxs("form",{onSubmit:H,className:"grid gap-3",children:[e.jsx(y,{name:"text",value:s.text,onChange:w,placeholder:"Question text",required:!0}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[e.jsx(y,{name:"category",value:s.category,onChange:w,placeholder:"Category",required:!0}),e.jsx(y,{name:"explanation",value:s.explanation,onChange:w,placeholder:"Explanation",required:!0}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("span",{className:"text-sm text-white/70",children:"Correcta"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:s.options.map((t,i)=>e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"radio",name:"correctAnswerIndex",checked:s.correctAnswerIndex===i,onChange:()=>r(c=>({...c,correctAnswerIndex:i})),className:"h-4 w-4"}),e.jsx("span",{children:i+1})]},i))})]})]}),e.jsx("div",{className:"grid gap-3 sm:grid-cols-2",children:s.options.map((t,i)=>e.jsx(y,{value:t,onChange:c=>Q(i,c.target.value),placeholder:`Option ${i+1}`,required:!0},i))}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[n&&e.jsx(b,{type:"button",variant:"secondary",onClick:()=>{r(E),h(null)},children:"Cancel"}),e.jsxs(b,{type:"submit",children:[n?"Update":"Add"," Question"]})]})]})})]}),e.jsxs(v,{children:[e.jsx(N,{className:"pb-2",children:e.jsx("h3",{className:"text-xl font-semibold",children:"Questions"})}),e.jsx(A,{children:k?e.jsxs("div",{className:"flex items-center gap-3 text-white/80",children:[e.jsx("div",{className:"loading-spinner"})," Loading…"]}):e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"text-left",children:e.jsxs("tr",{className:"border-b border-white/10",children:[e.jsx("th",{className:"py-2 pr-3",children:"Text"}),e.jsx("th",{className:"py-2 pr-3",children:"Category"}),e.jsx("th",{className:"py-2 pr-3",children:"Options"}),e.jsx("th",{className:"py-2 pr-3",children:"Correct"}),e.jsx("th",{className:"py-2 pr-3",children:"Explanation"}),e.jsx("th",{className:"py-2",children:"Actions"})]})}),e.jsx("tbody",{children:S.map(t=>e.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5",children:[e.jsx("td",{className:"py-2 pr-3 align-top",children:t.text}),e.jsx("td",{className:"py-2 pr-3 align-top",children:t.category}),e.jsx("td",{className:"py-2 pr-3 align-top",children:t.options.join(", ")}),e.jsx("td",{className:"py-2 pr-3 align-top",children:t.options[t.correctAnswerIndex]}),e.jsx("td",{className:"py-2 pr-3 align-top",children:t.explanation}),e.jsxs("td",{className:"py-2 flex gap-2",children:[e.jsx(b,{variant:"secondary",onClick:()=>I(t),children:"Edit"}),e.jsx(b,{variant:"outline",onClick:()=>q(t.id),children:"Delete"})]})]},t.id))})]})})})]}),j&&e.jsx(P,{intent:j.includes("Error")?"error":"success",children:j})]})}export{J as default};
//# sourceMappingURL=AdminPage-BeRdDqhU.js.map
