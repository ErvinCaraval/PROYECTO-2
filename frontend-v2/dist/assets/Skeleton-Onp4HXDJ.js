import{r as s,j as m}from"./index-BOaVjrce.js";import{M as A,i as N,u as z,P as W,a as D,b as H,L as K}from"./socket-CnHv-2vf.js";function L(e,o){if(typeof e=="function")return e(o);e!=null&&(e.current=o)}function T(...e){return o=>{let t=!1;const r=e.map(i=>{const n=L(i,o);return!t&&typeof n=="function"&&(t=!0),n});if(t)return()=>{for(let i=0;i<r.length;i++){const n=r[i];typeof n=="function"?n():L(e[i],null)}}}}function U(...e){return s.useCallback(T(...e),e)}class _ extends s.Component{getSnapshotBeforeUpdate(o){const t=this.props.childRef.current;if(t&&o.isPresent&&!this.props.isPresent){const r=t.offsetParent,i=N(r)&&r.offsetWidth||0,n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft,n.right=i-n.width-n.left}return null}componentDidUpdate(){}render(){return this.props.children}}function B({children:e,isPresent:o,anchorX:t,root:r}){const i=s.useId(),n=s.useRef(null),h=s.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:y}=s.useContext(A),E=U(n,e==null?void 0:e.ref);return s.useInsertionEffect(()=>{const{width:u,height:C,top:f,left:a,right:d}=h.current;if(o||!n.current||!u||!C)return;const x=t==="left"?`left: ${a}`:`right: ${d}`;n.current.dataset.motionPopId=i;const c=document.createElement("style");y&&(c.nonce=y);const j=r??document.head;return j.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${C}px !important;
            ${x}px !important;
            top: ${f}px !important;
          }
        `),()=>{j.contains(c)&&j.removeChild(c)}},[o]),m.jsx(_,{isPresent:o,childRef:n,sizeRef:h,children:s.cloneElement(e,{ref:E})})}const F=({children:e,initial:o,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:n,mode:h,anchorX:y,root:E})=>{const u=z(G),C=s.useId();let f=!0,a=s.useMemo(()=>(f=!1,{id:C,initial:o,isPresent:t,custom:i,onExitComplete:d=>{u.set(d,!0);for(const x of u.values())if(!x)return;r&&r()},register:d=>(u.set(d,!1),()=>u.delete(d))}),[t,u,r]);return n&&f&&(a={...a}),s.useMemo(()=>{u.forEach((d,x)=>u.set(x,!1))},[t]),s.useEffect(()=>{!t&&!u.size&&r&&r()},[t]),h==="popLayout"&&(e=m.jsx(B,{isPresent:t,anchorX:y,root:E,children:e})),m.jsx(W.Provider,{value:a,children:e})};function G(){return new Map}const w=e=>e.key||"";function S(e){const o=[];return s.Children.forEach(e,t=>{s.isValidElement(t)&&o.push(t)}),o}const J=({children:e,custom:o,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:n="sync",propagate:h=!1,anchorX:y="left",root:E})=>{const[u,C]=D(h),f=s.useMemo(()=>S(e),[e]),a=h&&!u?[]:f.map(w),d=s.useRef(!0),x=s.useRef(f),c=z(()=>new Map),[j,I]=s.useState(f),[g,k]=s.useState(f);H(()=>{d.current=!1,x.current=f;for(let p=0;p<g.length;p++){const l=w(g[p]);a.includes(l)?c.delete(l):c.get(l)!==!0&&c.set(l,!1)}},[g,a.length,a.join("-")]);const P=[];if(f!==j){let p=[...f];for(let l=0;l<g.length;l++){const R=g[l],$=w(R);a.includes($)||(p.splice(l,0,R),P.push(R))}return n==="wait"&&P.length&&(p=P),k(S(p)),I(f),null}const{forceRender:M}=s.useContext(K);return m.jsx(m.Fragment,{children:g.map(p=>{const l=w(p),R=h&&!u?!1:f===g||a.includes(l),$=()=>{if(c.has(l))c.set(l,!0);else return;let v=!0;c.forEach(b=>{b||(v=!1)}),v&&(M==null||M(),k(x.current),h&&(C==null||C()),r&&r())};return m.jsx(F,{isPresent:R,initial:!d.current||t?void 0:!1,custom:o,presenceAffectsLayout:i,mode:n,root:E,onExitComplete:R?void 0:$,anchorX:y,children:p},l)})})};function V({className:e=""}){return m.jsx("div",{className:`skeleton rounded-md ${e}`})}function O({lines:e=3}){return m.jsx("div",{className:"space-y-2",children:Array.from({length:e}).map((o,t)=>m.jsx(V,{className:`h-3 ${t===e-1?"w-2/3":"w-full"}`},t))})}export{J as A,V as S,O as a};
//# sourceMappingURL=Skeleton-Onp4HXDJ.js.map
