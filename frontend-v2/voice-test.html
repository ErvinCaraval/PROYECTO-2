<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Voz - BrainBlitz</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .container {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #45a049;
        }
        .status {
            background: #333;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #555;
            border-radius: 5px;
            background: #333;
            color: white;
        }
        .voice-list {
            max-height: 200px;
            overflow-y: auto;
            background: #333;
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>üîä Prueba de Voz - BrainBlitz</h1>
    
    <div class="container">
        <h2>Informaci√≥n del Sistema</h2>
        <div id="systemInfo" class="status">
            Cargando informaci√≥n del sistema...
        </div>
    </div>

    <div class="container">
        <h2>Prueba de Voz</h2>
        <input type="text" id="textInput" placeholder="Escribe el texto que quieres que se lea..." value="Hola, este es un test de voz. Si puedes escuchar esto, el sistema de voz est√° funcionando correctamente.">
        <br>
        <button onclick="speakText()">üîä Leer Texto</button>
        <button onclick="stopSpeaking()">‚èπÔ∏è Detener</button>
        <button onclick="pauseSpeaking()">‚è∏Ô∏è Pausar</button>
        <button onclick="resumeSpeaking()">‚ñ∂Ô∏è Reanudar</button>
    </div>

    <div class="container">
        <h2>Configuraci√≥n de Voz</h2>
        <label>Velocidad: <input type="range" id="rateSlider" min="0.1" max="2" step="0.1" value="1" onchange="updateSettings()"></label>
        <span id="rateValue">1.0</span><br>
        <label>Volumen: <input type="range" id="volumeSlider" min="0" max="1" step="0.1" value="1" onchange="updateSettings()"></label>
        <span id="volumeValue">1.0</span><br>
        <label>Tono: <input type="range" id="pitchSlider" min="0" max="2" step="0.1" value="1" onchange="updateSettings()"></label>
        <span id="pitchValue">1.0</span><br>
        <label>Idioma: 
            <select id="languageSelect" onchange="updateSettings()">
                <option value="es-ES">Espa√±ol (Espa√±a)</option>
                <option value="es-MX">Espa√±ol (M√©xico)</option>
                <option value="es-AR">Espa√±ol (Argentina)</option>
                <option value="en-US">English (US)</option>
            </select>
        </label>
    </div>

    <div class="container">
        <h2>Voces Disponibles</h2>
        <div id="voiceList" class="voice-list">
            Cargando voces...
        </div>
    </div>

    <script>
        let currentUtterance = null;
        let voices = [];

        // Cargar voces cuando est√©n disponibles
        function loadVoices() {
            voices = speechSynthesis.getVoices();
            displayVoices();
        }

        // Mostrar voces disponibles
        function displayVoices() {
            const voiceList = document.getElementById('voiceList');
            if (voices.length === 0) {
                voiceList.innerHTML = 'No hay voces disponibles';
                return;
            }

            let html = '<h3>Voces encontradas:</h3>';
            voices.forEach((voice, index) => {
                html += `<div style="margin: 5px 0; padding: 5px; background: #444; border-radius: 3px;">
                    <strong>${voice.name}</strong><br>
                    Idioma: ${voice.lang} | G√©nero: ${voice.gender || 'N/A'}<br>
                    <button onclick="selectVoice(${index})">Seleccionar</button>
                </div>`;
            });
            voiceList.innerHTML = html;
        }

        // Seleccionar voz
        function selectVoice(index) {
            if (voices[index]) {
                console.log('Voz seleccionada:', voices[index]);
                alert('Voz seleccionada: ' + voices[index].name);
            }
        }

        // Hablar texto
        function speakText() {
            const text = document.getElementById('textInput').value;
            if (!text.trim()) {
                alert('Por favor, escribe alg√∫n texto');
                return;
            }

            // Detener cualquier voz actual
            stopSpeaking();

            // Crear nueva utterance
            currentUtterance = new SpeechSynthesisUtterance(text);
            
            // Aplicar configuraci√≥n
            currentUtterance.rate = parseFloat(document.getElementById('rateSlider').value);
            currentUtterance.volume = parseFloat(document.getElementById('volumeSlider').value);
            currentUtterance.pitch = parseFloat(document.getElementById('pitchSlider').value);
            currentUtterance.lang = document.getElementById('languageSelect').value;

            // Eventos
            currentUtterance.onstart = function() {
                console.log('Comenzando a hablar...');
                updateSystemInfo();
            };

            currentUtterance.onend = function() {
                console.log('Termin√≥ de hablar');
                currentUtterance = null;
                updateSystemInfo();
            };

            currentUtterance.onerror = function(event) {
                console.error('Error en s√≠ntesis de voz:', event.error);
                alert('Error: ' + event.error);
                currentUtterance = null;
                updateSystemInfo();
            };

            // Hablar
            speechSynthesis.speak(currentUtterance);
            updateSystemInfo();
        }

        // Detener voz
        function stopSpeaking() {
            speechSynthesis.cancel();
            currentUtterance = null;
            updateSystemInfo();
        }

        // Pausar voz
        function pauseSpeaking() {
            speechSynthesis.pause();
            updateSystemInfo();
        }

        // Reanudar voz
        function resumeSpeaking() {
            speechSynthesis.resume();
            updateSystemInfo();
        }

        // Actualizar configuraci√≥n
        function updateSettings() {
            document.getElementById('rateValue').textContent = document.getElementById('rateSlider').value;
            document.getElementById('volumeValue').textContent = document.getElementById('volumeSlider').value;
            document.getElementById('pitchValue').textContent = document.getElementById('pitchSlider').value;
        }

        // Actualizar informaci√≥n del sistema
        function updateSystemInfo() {
            const info = document.getElementById('systemInfo');
            const isSupported = 'speechSynthesis' in window;
            const isSpeaking = speechSynthesis.speaking;
            const isPaused = speechSynthesis.paused;
            const voiceCount = voices.length;

            info.innerHTML = `
                <strong>Soporte de Web Speech API:</strong> ${isSupported ? '‚úÖ S√≠' : '‚ùå No'}<br>
                <strong>Estado actual:</strong> ${isSpeaking ? 'üîä Hablando' : isPaused ? '‚è∏Ô∏è Pausado' : 'üîá Silencioso'}<br>
                <strong>Voces disponibles:</strong> ${voiceCount}<br>
                <strong>Navegador:</strong> ${navigator.userAgent.split(' ')[0]}
            `;
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            updateSystemInfo();
            updateSettings();
            
            // Cargar voces inmediatamente
            loadVoices();
            
            // Tambi√©n cargar cuando cambien las voces
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
            
            // Actualizar informaci√≥n cada segundo
            setInterval(updateSystemInfo, 1000);
        });
    </script>
</body>
</html>
